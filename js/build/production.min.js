function run_p3(){return!p3_window_loaded&&p3_window_wait||!p3_loader_complete?!1:("undefined"!=typeof window.p3_async_before_init&&window.p3_async_before_init(),"undefined"!=typeof window.p3_async_init&&window.p3_async_init(),"undefined"!=typeof p3_instances&&"undefined"!=typeof p3_api_key&&P3.init(p3_instances,p3_api_key),"undefined"!=typeof window.p3_async_after_init&&window.p3_async_after_init(),void 0)}function receiveOoyalaP3Event(a,b,c){switch(b){case"apiReady":p3_ooyala_initialized.push(a);break;case"playheadTimeChanged":var d=P3.find_instance_by_player_reference(a);d&&(d.player.interface.playhead_time=parseInt(1e3*parseFloat(c.playheadTime)));break;case"stateChanged":P3.Log.log("Ooyala state change: "+c.state);break;case"currentItemEmbedCodeChanged":break;case"embedCodeChanged":var e=c.embedCode,d=P3.find_instance_by_player_reference(e);d.player_reference=a,p3_ooyala_interfaces[a]=d.player.interface,P3.Log.info("Ooyala Current Embed Code Changed");break;case"totalTimeChanged":var d=P3.find_instance_by_player_reference(a);d&&(d.player.interface.total_time=parseInt(1e3*parseFloat(c.totalTime)))}}function html5_kaltura_play_handler(){P3.get(0).player.interface.player_state="PLAYING"}function html5_kaltura_pause_handler(){P3.get(0).player.interface.player_state="PAUSED"}function html5_kaltura_update_playhead(a){P3.get(0).player.interface.player_state="PLAYING",P3.get(0).player.interface.playhead_time=1e3*parseFloat(a)}function p3_listen(a,b,c){P3.JQuery(P3.get(a)).bind(b,c)}!function(a,b,c,d,e,f){function g(a,b){var c=typeof a[b];return"function"==c||"object"==c&&!!a[b]||"unknown"==c}function h(a,b){return"object"==typeof a[b]&&!!a[b]}function i(a){return"[object Array]"===Object.prototype.toString.call(a)}function j(){var a="Shockwave Flash",b="application/x-shockwave-flash";if(!t(navigator.plugins)&&"object"==typeof navigator.plugins[a]){var c=navigator.plugins[a].description;c&&!t(navigator.mimeTypes)&&navigator.mimeTypes[b]&&navigator.mimeTypes[b].enabledPlugin&&(C=c.match(/\d+/g))}if(!C){var d;try{d=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),C=Array.prototype.slice.call(d.GetVariable("$version").match(/(\d+),(\d+),(\d+),(\d+)/),1),d=null}catch(e){}}if(!C)return!1;var f=parseInt(C[0],10),g=parseInt(C[1],10);return D=f>9&&g>0,!0}function k(){if(!S){S=!0;for(var a=0;a<T.length;a++)T[a]();T.length=0}}function l(a,b){return S?void a.call(b):void T.push(function(){a.call(b)})}function m(){var a=parent;if(""!==M)for(var b=0,c=M.split(".");b<c.length;b++)a=a[c[b]];return a.easyXDM}function n(b){return a.easyXDM=O,M=b,M&&(P="easyXDM_"+M.replace(".","_")+"_"),N}function o(a){return a.match(J)[3]}function p(a){return a.match(J)[4]||""}function q(a){var b=a.toLowerCase().match(J),c=b[2],d=b[3],e=b[4]||"";return("http:"==c&&":80"==e||"https:"==c&&":443"==e)&&(e=""),c+"//"+d+e}function r(a){if(a=a.replace(L,"$1/"),!a.match(/^(http||https):\/\//)){var b="/"===a.substring(0,1)?"":c.pathname;"/"!==b.substring(b.length-1)&&(b=b.substring(0,b.lastIndexOf("/")+1)),a=c.protocol+"//"+c.host+b+a}for(;K.test(a);)a=a.replace(K,"");return a}function s(a,b){var c="",d=a.indexOf("#");-1!==d&&(c=a.substring(d),a=a.substring(0,d));var e=[];for(var g in b)b.hasOwnProperty(g)&&e.push(g+"="+f(b[g]));return a+(Q?"#":-1==a.indexOf("?")?"?":"&")+e.join("&")+c}function t(a){return"undefined"==typeof a}function u(a,b,c){var d;for(var e in b)b.hasOwnProperty(e)&&(e in a?(d=b[e],"object"==typeof d?u(a[e],d,c):c||(a[e]=b[e])):a[e]=b[e]);return a}function v(){var a=b.body.appendChild(b.createElement("form")),c=a.appendChild(b.createElement("input"));c.name=P+"TEST"+H,B=c!==a.elements[c.name],b.body.removeChild(a)}function w(a){t(B)&&v();var c;B?c=b.createElement('<iframe name="'+a.props.name+'"/>'):(c=b.createElement("IFRAME"),c.name=a.props.name),c.id=c.name=a.props.name,delete a.props.name,"string"==typeof a.container&&(a.container=b.getElementById(a.container)),a.container||(u(c.style,{position:"absolute",top:"-2000px",left:"0px"}),a.container=b.body);var d=a.props.src;if(a.props.src="javascript:false",u(c,a.props),c.border=c.frameBorder=0,c.allowTransparency=!0,a.container.appendChild(c),a.onLoad&&E(c,"load",a.onLoad),a.usePost){var e,f=a.container.appendChild(b.createElement("form"));if(f.target=c.name,f.action=d,f.method="POST","object"==typeof a.usePost)for(var g in a.usePost)a.usePost.hasOwnProperty(g)&&(B?e=b.createElement('<input name="'+g+'"/>'):(e=b.createElement("INPUT"),e.name=g),e.value=a.usePost[g],f.appendChild(e));f.submit(),f.parentNode.removeChild(f)}else c.src=d;return a.props.src=d,c}function x(a,b){"string"==typeof a&&(a=[a]);for(var c,d=a.length;d--;)if(c=a[d],c=new RegExp("^"==c.substr(0,1)?c:"^"+c.replace(/(\*)/g,".$1").replace(/\?/g,".")+"$"),c.test(b))return!0;return!1}function y(d){var e,f=d.protocol;if(d.isHost=d.isHost||t(V.xdm_p),Q=d.hash||!1,d.props||(d.props={}),d.isHost)d.remote=r(d.remote),d.channel=d.channel||"default"+H++,d.secret=Math.random().toString(16).substring(2),t(f)&&(f=q(c.href)==q(d.remote)?"4":g(a,"postMessage")||g(b,"postMessage")?"1":d.swf&&g(a,"ActiveXObject")&&j()?"6":"Gecko"===navigator.product&&"frameElement"in a&&-1==navigator.userAgent.indexOf("WebKit")?"5":d.remoteHelper?"2":"0");else if(d.channel=V.xdm_c.replace(/["'<>\\]/g,""),d.secret=V.xdm_s,d.remote=V.xdm_e.replace(/["'<>\\]/g,""),f=V.xdm_p,d.acl&&!x(d.acl,d.remote))throw new Error("Access denied for "+d.remote);switch(d.protocol=f,f){case"0":if(u(d,{interval:100,delay:2e3,useResize:!0,useParent:!1,usePolling:!1},!0),d.isHost){if(!d.local){for(var h,i=c.protocol+"//"+c.host,k=b.body.getElementsByTagName("img"),l=k.length;l--;)if(h=k[l],h.src.substring(0,i.length)===i){d.local=h.src;break}d.local||(d.local=a)}var m={xdm_c:d.channel,xdm_p:0};d.local===a?(d.usePolling=!0,d.useParent=!0,d.local=c.protocol+"//"+c.host+c.pathname+c.search,m.xdm_e=d.local,m.xdm_pa=1):m.xdm_e=r(d.local),d.container&&(d.useResize=!1,m.xdm_po=1),d.remote=s(d.remote,m)}else u(d,{channel:V.xdm_c,remote:V.xdm_e,useParent:!t(V.xdm_pa),usePolling:!t(V.xdm_po),useResize:d.useParent?!1:d.useResize});e=[new N.stack.HashTransport(d),new N.stack.ReliableBehavior({}),new N.stack.QueueBehavior({encode:!0,maxLength:4e3-d.remote.length}),new N.stack.VerifyBehavior({initiate:d.isHost})];break;case"1":e=[new N.stack.PostMessageTransport(d)];break;case"2":d.remoteHelper=r(d.remoteHelper),e=[new N.stack.NameTransport(d),new N.stack.QueueBehavior,new N.stack.VerifyBehavior({initiate:d.isHost})];break;case"3":e=[new N.stack.NixTransport(d)];break;case"4":e=[new N.stack.SameOriginTransport(d)];break;case"5":e=[new N.stack.FrameElementTransport(d)];break;case"6":C||j(),e=[new N.stack.FlashTransport(d)]}return e.push(new N.stack.QueueBehavior({lazy:d.lazy,remove:!0})),e}function z(a){for(var b,c={incoming:function(a,b){this.up.incoming(a,b)},outgoing:function(a,b){this.down.outgoing(a,b)},callback:function(a){this.up.callback(a)},init:function(){this.down.init()},destroy:function(){this.down.destroy()}},d=0,e=a.length;e>d;d++)b=a[d],u(b,c,!0),0!==d&&(b.down=a[d-1]),d!==e-1&&(b.up=a[d+1]);return b}function A(a){a.up.down=a.down,a.down.up=a.up,a.up=a.down=null}var B,C,D,E,F,G=this,H=Math.floor(1e4*Math.random()),I=Function.prototype,J=/^((http.?:)\/\/([^:\/\s]+)(:\d+)*)/,K=/[\-\w]+\/\.\.\//,L=/([^:])\/\//g,M="",N={},O=a.easyXDM,P="easyXDM_",Q=!1;if(g(a,"addEventListener"))E=function(a,b,c){a.addEventListener(b,c,!1)},F=function(a,b,c){a.removeEventListener(b,c,!1)};else{if(!g(a,"attachEvent"))throw new Error("Browser not supported");E=function(a,b,c){a.attachEvent("on"+b,c)},F=function(a,b,c){a.detachEvent("on"+b,c)}}var R,S=!1,T=[];if("readyState"in b?(R=b.readyState,S="complete"==R||~navigator.userAgent.indexOf("AppleWebKit/")&&("loaded"==R||"interactive"==R)):S=!!b.body,!S){if(g(a,"addEventListener"))E(b,"DOMContentLoaded",k);else if(E(b,"readystatechange",function(){"complete"==b.readyState&&k()}),b.documentElement.doScroll&&a===top){var U=function(){if(!S){try{b.documentElement.doScroll("left")}catch(a){return void d(U,1)}k()}};U()}E(a,"load",k)}var V=function(a){a=a.substring(1).split("&");for(var b,c={},d=a.length;d--;)b=a[d].split("="),c[b[0]]=e(b[1]);return c}(/xdm_e=/.test(c.search)?c.search:c.hash),W=function(){var a={},b={a:[1,2,3]},c='{"a":[1,2,3]}';return"undefined"!=typeof JSON&&"function"==typeof JSON.stringify&&JSON.stringify(b).replace(/\s/g,"")===c?JSON:(Object.toJSON&&Object.toJSON(b).replace(/\s/g,"")===c&&(a.stringify=Object.toJSON),"function"==typeof String.prototype.evalJSON&&(b=c.evalJSON(),b.a&&3===b.a.length&&3===b.a[2]&&(a.parse=function(a){return a.evalJSON()})),a.stringify&&a.parse?(W=function(){return a},a):null)};u(N,{version:"2.4.16.3",query:V,stack:{},apply:u,getJSONObject:W,whenReady:l,noConflict:n}),N.DomHelper={on:E,un:F,requiresJSON:function(c){h(a,"JSON")||b.write('<script type="text/javascript" src="'+c+'"></script>')}},function(){var a={};N.Fn={set:function(b,c){a[b]=c},get:function(b,c){var d=a[b];return c&&delete a[b],d}}}(),N.Socket=function(a){var b=z(y(a).concat([{incoming:function(b,c){a.onMessage(b,c)},callback:function(b){a.onReady&&a.onReady(b)}}])),c=q(a.remote);this.origin=q(a.remote),this.destroy=function(){b.destroy()},this.postMessage=function(a){b.outgoing(a,c)},b.init()},N.Rpc=function(a,b){if(b.local)for(var c in b.local)if(b.local.hasOwnProperty(c)){var d=b.local[c];"function"==typeof d&&(b.local[c]={method:d})}var e=z(y(a).concat([new N.stack.RpcBehavior(this,b),{callback:function(b){a.onReady&&a.onReady(b)}}]));this.origin=q(a.remote),this.destroy=function(){e.destroy()},e.init()},N.stack.SameOriginTransport=function(a){var b,e,f,g;return b={outgoing:function(a,b,c){f(a),c&&c()},destroy:function(){e&&(e.parentNode.removeChild(e),e=null)},onDOMReady:function(){g=q(a.remote),a.isHost?(u(a.props,{src:s(a.remote,{xdm_e:c.protocol+"//"+c.host+c.pathname,xdm_c:a.channel,xdm_p:4}),name:P+a.channel+"_provider"}),e=w(a),N.Fn.set(a.channel,function(a){return f=a,d(function(){b.up.callback(!0)},0),function(a){b.up.incoming(a,g)}})):(f=m().Fn.get(a.channel,!0)(function(a){b.up.incoming(a,g)}),d(function(){b.up.callback(!0)},0))},init:function(){l(b.onDOMReady,b)}}},N.stack.FlashTransport=function(a){function e(a){d(function(){g.up.incoming(a,i)},0)}function f(c){var d=a.swf+"?host="+a.isHost,e="easyXDM_swf_"+Math.floor(1e4*Math.random());N.Fn.set("flash_loaded"+c.replace(/[\-.]/g,"_"),function(){N.stack.FlashTransport[c].swf=j=k.firstChild;for(var a=N.stack.FlashTransport[c].queue,b=0;b<a.length;b++)a[b]();a.length=0}),a.swfContainer?k="string"==typeof a.swfContainer?b.getElementById(a.swfContainer):a.swfContainer:(k=b.createElement("div"),u(k.style,D&&a.swfNoThrottle?{height:"20px",width:"20px",position:"fixed",right:0,top:0}:{height:"1px",width:"1px",position:"absolute",overflow:"hidden",right:0,top:0}),b.body.appendChild(k));var f="callback=flash_loaded"+c.replace(/[\-.]/g,"_")+"&proto="+G.location.protocol+"&domain="+o(G.location.href)+"&port="+p(G.location.href)+"&ns="+M;k.innerHTML="<object height='20' width='20' type='application/x-shockwave-flash' id='"+e+"' data='"+d+"'><param name='allowScriptAccess' value='always'></param><param name='wmode' value='transparent'><param name='movie' value='"+d+"'></param><param name='flashvars' value='"+f+"'></param><embed type='application/x-shockwave-flash' FlashVars='"+f+"' allowScriptAccess='always' wmode='transparent' src='"+d+"' height='1' width='1'></embed></object>"}var g,h,i,j,k;return g={outgoing:function(b,c,d){j.postMessage(a.channel,b.toString()),d&&d()},destroy:function(){try{j.destroyChannel(a.channel)}catch(b){}j=null,h&&(h.parentNode.removeChild(h),h=null)},onDOMReady:function(){i=a.remote,N.Fn.set("flash_"+a.channel+"_init",function(){d(function(){g.up.callback(!0)})}),N.Fn.set("flash_"+a.channel+"_onMessage",e),a.swf=r(a.swf);var b=o(a.swf),k=function(){N.stack.FlashTransport[b].init=!0,j=N.stack.FlashTransport[b].swf,j.createChannel(a.channel,a.secret,q(a.remote),a.isHost),a.isHost&&(D&&a.swfNoThrottle&&u(a.props,{position:"fixed",right:0,top:0,height:"20px",width:"20px"}),u(a.props,{src:s(a.remote,{xdm_e:q(c.href),xdm_c:a.channel,xdm_p:6,xdm_s:a.secret}),name:P+a.channel+"_provider"}),h=w(a))};N.stack.FlashTransport[b]&&N.stack.FlashTransport[b].init?k():N.stack.FlashTransport[b]?N.stack.FlashTransport[b].queue.push(k):(N.stack.FlashTransport[b]={queue:[k]},f(b))},init:function(){l(g.onDOMReady,g)}}},N.stack.PostMessageTransport=function(b){function e(a){if(a.origin)return q(a.origin);if(a.uri)return q(a.uri);if(a.domain)return c.protocol+"//"+a.domain;throw"Unable to retrieve the origin of the event"}function f(a){var c=e(a);c==j&&a.data.substring(0,b.channel.length+1)==b.channel+" "&&g.up.incoming(a.data.substring(b.channel.length+1),c)}var g,h,i,j;return g={outgoing:function(a,c,d){i.postMessage(b.channel+" "+a,c||j),d&&d()},destroy:function(){F(a,"message",f),h&&(i=null,h.parentNode.removeChild(h),h=null)},onDOMReady:function(){if(j=q(b.remote),b.isHost){var e=function(c){c.data==b.channel+"-ready"&&(i="postMessage"in h.contentWindow?h.contentWindow:h.contentWindow.document,F(a,"message",e),E(a,"message",f),d(function(){g.up.callback(!0)},0))};E(a,"message",e),u(b.props,{src:s(b.remote,{xdm_e:q(c.href),xdm_c:b.channel,xdm_p:1}),name:P+b.channel+"_provider"}),h=w(b)}else E(a,"message",f),i="postMessage"in a.parent?a.parent:a.parent.document,i.postMessage(b.channel+"-ready",j),d(function(){g.up.callback(!0)},0)},init:function(){l(g.onDOMReady,g)}}},N.stack.FrameElementTransport=function(e){var f,g,h,i;return f={outgoing:function(a,b,c){h.call(this,a),c&&c()},destroy:function(){g&&(g.parentNode.removeChild(g),g=null)},onDOMReady:function(){i=q(e.remote),e.isHost?(u(e.props,{src:s(e.remote,{xdm_e:q(c.href),xdm_c:e.channel,xdm_p:5}),name:P+e.channel+"_provider"}),g=w(e),g.fn=function(a){return delete g.fn,h=a,d(function(){f.up.callback(!0)},0),function(a){f.up.incoming(a,i)}}):(b.referrer&&q(b.referrer)!=V.xdm_e&&(a.top.location=V.xdm_e),h=a.frameElement.fn(function(a){f.up.incoming(a,i)}),f.up.callback(!0))},init:function(){l(f.onDOMReady,f)}}},N.stack.NameTransport=function(a){function b(b){var c=a.remoteHelper+(h?"#_3":"#_2")+a.channel;i.contentWindow.sendMessage(b,c)}function c(){h?(2===++k||!h)&&g.up.callback(!0):(b("ready"),g.up.callback(!0))}function e(a){g.up.incoming(a,n)}function f(){m&&d(function(){m(!0)},0)}var g,h,i,j,k,m,n,o;return g={outgoing:function(a,c,d){m=d,b(a)},destroy:function(){i.parentNode.removeChild(i),i=null,h&&(j.parentNode.removeChild(j),j=null)},onDOMReady:function(){h=a.isHost,k=0,n=q(a.remote),a.local=r(a.local),h?(N.Fn.set(a.channel,function(b){h&&"ready"===b&&(N.Fn.set(a.channel,e),c())}),o=s(a.remote,{xdm_e:a.local,xdm_c:a.channel,xdm_p:2}),u(a.props,{src:o+"#"+a.channel,name:P+a.channel+"_provider"}),j=w(a)):(a.remoteHelper=a.remote,N.Fn.set(a.channel,e));var b=function(){var e=i||this;F(e,"load",b),N.Fn.set(a.channel+"_load",f),function g(){"function"==typeof e.contentWindow.sendMessage?c():d(g,50)}()};i=w({props:{src:a.local+"#_4"+a.channel},onLoad:b})},init:function(){l(g.onDOMReady,g)}}},N.stack.HashTransport=function(b){function c(a){if(p){var c=b.remote+"#"+n++ +"_"+a;(i||!r?p.contentWindow:p).location=c}}function e(a){m=a,h.up.incoming(m.substring(m.indexOf("_")+1),s)}function f(){if(o){var a=o.location.href,b="",c=a.indexOf("#");-1!=c&&(b=a.substring(c)),b&&b!=m&&e(b)}}function g(){j=setInterval(f,k)}var h,i,j,k,m,n,o,p,r,s;return h={outgoing:function(a){c(a)},destroy:function(){a.clearInterval(j),(i||!r)&&p.parentNode.removeChild(p),p=null},onDOMReady:function(){if(i=b.isHost,k=b.interval,m="#"+b.channel,n=0,r=b.useParent,s=q(b.remote),i){if(u(b.props,{src:b.remote,name:P+b.channel+"_provider"}),r)b.onLoad=function(){o=a,g(),h.up.callback(!0)};else{var c=0,e=b.delay/50;!function f(){if(++c>e)throw new Error("Unable to reference listenerwindow");try{o=p.contentWindow.frames[P+b.channel+"_consumer"]}catch(a){}o?(g(),h.up.callback(!0)):d(f,50)}()}p=w(b)}else o=a,g(),r?(p=parent,h.up.callback(!0)):(u(b,{props:{src:b.remote+"#"+b.channel+new Date,name:P+b.channel+"_consumer"},onLoad:function(){h.up.callback(!0)}}),p=w(b))},init:function(){l(h.onDOMReady,h)}}},N.stack.ReliableBehavior=function(){var a,b,c=0,d=0,e="";return a={incoming:function(f,g){var h=f.indexOf("_"),i=f.substring(0,h).split(",");f=f.substring(h+1),i[0]==c&&(e="",b&&(b(!0),b=null)),f.length>0&&(a.down.outgoing(i[1]+","+c+"_"+e,g),d!=i[1]&&(d=i[1],a.up.incoming(f,g)))},outgoing:function(f,g,h){e=f,b=h,a.down.outgoing(d+","+ ++c+"_"+f,g)}}},N.stack.QueueBehavior=function(a){function b(){if(a.remove&&0===h.length)return void A(c);if(!i&&0!==h.length&&!g){i=!0;var e=h.shift();c.down.outgoing(e.data,e.origin,function(a){i=!1,e.callback&&d(function(){e.callback(a)},0),b()})}}var c,g,h=[],i=!0,j="",k=0,l=!1,m=!1;return c={init:function(){t(a)&&(a={}),a.maxLength&&(k=a.maxLength,m=!0),a.lazy?l=!0:c.down.init()},callback:function(a){i=!1;var d=c.up;b(),d.callback(a)},incoming:function(b,d){if(m){var f=b.indexOf("_"),g=parseInt(b.substring(0,f),10);j+=b.substring(f+1),0===g&&(a.encode&&(j=e(j)),c.up.incoming(j,d),j="")}else c.up.incoming(b,d)},outgoing:function(d,e,g){a.encode&&(d=f(d));var i,j=[];if(m){for(;0!==d.length;)i=d.substring(0,k),d=d.substring(i.length),j.push(i);for(;i=j.shift();)h.push({data:j.length+"_"+i,origin:e,callback:0===j.length?g:null})}else h.push({data:d,origin:e,callback:g});l?c.down.init():b()},destroy:function(){g=!0,c.down.destroy()}}},N.stack.VerifyBehavior=function(a){function b(){d=Math.random().toString(16).substring(2),c.down.outgoing(d)}var c,d,e;return c={incoming:function(f,g){var h=f.indexOf("_");-1===h?f===d?c.up.callback(!0):e||(e=f,a.initiate||b(),c.down.outgoing(f)):f.substring(0,h)===e&&c.up.incoming(f.substring(h+1),g)},outgoing:function(a,b,e){c.down.outgoing(d+"_"+a,b,e)},callback:function(){a.initiate&&b()}}},N.stack.RpcBehavior=function(a,b){function c(a){a.jsonrpc="2.0",f.down.outgoing(g.stringify(a))}function d(a,b){var d=Array.prototype.slice;return function(){var e,f=arguments.length,g={method:b};f>0&&"function"==typeof arguments[f-1]?(f>1&&"function"==typeof arguments[f-2]?(e={success:arguments[f-2],error:arguments[f-1]},g.params=d.call(arguments,0,f-2)):(e={success:arguments[f-1]},g.params=d.call(arguments,0,f-1)),j[""+ ++h]=e,g.id=h):g.params=d.call(arguments,0),a.namedParams&&1===g.params.length&&(g.params=g.params[0]),c(g)}}function e(a,b,d,e){if(!d)return void(b&&c({id:b,error:{code:-32601,message:"Procedure not found."}}));var f,g;b?(f=function(a){f=I,c({id:b,result:a})},g=function(a,d){g=I;var e={id:b,error:{code:-32099,message:a}};d&&(e.error.data=d),c(e)}):f=g=I,i(e)||(e=[e]);try{var h=d.method.apply(d.scope,e.concat([f,g]));t(h)||f(h)}catch(j){g(j.message)}}var f,g=b.serializer||W(),h=0,j={};return f={incoming:function(a){var d=g.parse(a);if(d.method)b.handle?b.handle(d,c):e(d.method,d.id,b.local[d.method],d.params);else{var f=j[d.id];d.error?f.error&&f.error(d.error):f.success&&f.success(d.result),delete j[d.id]}},init:function(){if(b.remote)for(var c in b.remote)b.remote.hasOwnProperty(c)&&(a[c]=d(b.remote[c],c));f.down.init()},destroy:function(){for(var c in b.remote)b.remote.hasOwnProperty(c)&&a.hasOwnProperty(c)&&delete a[c];f.down.destroy()}}},G.easyXDM=N}(window,document,location,window.setTimeout,decodeURIComponent,encodeURIComponent);var P3={instances:[],init:function(a,b){if(!P3.is_compatible())return!1;P3.Settings.api_key=P3.Settings.api_key||b;var c=P3.instances.length,d=!1;for(i in a)a[i].debugger_ui&&(d=!0),P3.instances.push(new P3.create_instance(i,a[i],c)),c++;d&&(P3.debugger_ui=new P3.DebuggerUI)},is_compatible:function(){return!0},browser_invalid:function(){switch(!0){case P3.JQuery.browser.msie&&parseFloat(P3.JQuery.browser.version)<6:return!0}return!1},create_instance:function(a,b,c){if(this.instance_index=c,this.settings=b,"simple"==b.api_version&&b.project_id&&(P3.Settings.api_host=P3.Settings.api_host.replace(/\.com.*$/,".com")+"/p/projects/"+b.project_id,P3.Settings.static_host=P3.Settings.static_host.replace(/\.com.*$/,".com")+"/p/projects/"+b.project_id),this.player_reference=a,this.player=new P3.Player(this,a,b),this.event=new P3.Event(this),this.settings.transcript&&this.settings.transcript.target&&(this.transcript=new P3.Transcript(this,b)),this.settings.playlist&&this.settings.playlist.target&&(this.playlist=new P3.Playlist(this,b)),this.settings.captions&&(this.captions=new P3.Captions(this,b)),this.settings.collection&&this.settings.collection.target){var d=this.instance_index;P3.Util.load_remote_script(P3.Settings.p3_host+"/javascripts/P3.Collection.js",function(){P3.get(d).collection=new P3.Collection(P3.get(d),P3.get(d).settings)})}if(this.settings.video_search&&this.settings.video_search.target){var d=this.instance_index;P3.Util.load_remote_script(P3.Settings.p3_host+"/javascripts/P3.VideoSearch.js",function(){P3.get(d).video_search=new P3.VideoSearch(P3.get(d),P3.get(d).settings)})}if(p3_extensions&&p3_extensions.length>0)for(var e=0;e<p3_extensions.length;e++){var f=p3_extensions[e].split("/").slice(-1)[0].replace(/\..*$/,"").replace(/\-/g,"_"),g=P3.Util.to_camel_case(f);this.settings[f]&&(this[f]=new P3[g](this,b))}},clear_instance:function(a){if("number"==typeof a)var b=P3.instances[a];else if("string"==typeof a)var b=P3.find_instance_by_player_reference(a);return b?(b.player.stop_tracking(),b.transcript&&b.transcript.die(),b.captions&&b.captions.die(),b.transcript=b.captions=null,P3.instances.splice(a,1),P3.index_instances(),void 0):(P3.Log.error("Could not find instance to clear: "+a),!1)},index_instances:function(){for(var a=0;a<P3.instances.length;a++)P3.instances[a].instance_index=a},find_instances_by_file_id:function(a){var b=[];return P3.JQuery.each(P3.instances,function(c){return P3.instances[c].settings.file_id==a?(b.push(P3.instances[c]),!1):void 0}),b},find_instances_by_video_id:function(a){var b=[];return P3.JQuery.each(P3.instances,function(c){return P3.instances[c].settings.platform_integration&&P3.instances[c].settings.file_id==a?(b.push(P3.instances[c]),!1):void 0}),b},find_instance_by_player_reference:function(a){var b=!1;return P3.JQuery.each(P3.instances,function(c){return P3.instances[c].player_reference==a?(b=P3.instances[c],!1):void 0}),b},get:function(a){return"number"==typeof a?this.instances[a]?this.instances[a]:!1:this.find_instance_by_player_reference(a)}};P3.About={supported_players:{brightcove:"Brightcove",delve:"Delve / Limelight",flowplayer:"Flowplayer",jw:"JW Player",kaltura:"Kaltura",ooyala:"Ooyala",vimeo:"Vimeo",vimeo_iframe:"Vimeo IFRAME",wistia:"Wistia",wistia_iframe:"Wistia IFRAME",youtube:"YouTube",soundmanager2:"SoundManager 2",html5:"HTML5",video_js:"Video.js"},plugins:{transcript:{label:"Interactive Transcript",support_doc:"http://support.3playmedia.com/forums/20752837-Interactive-Transcript"},captions:{label:"Captions",support_doc:"http://support.3playmedia.com/forums/20884686-Captions-Plugin"}},hosted_extensions:{captions_style:{label:"Captions Style",support_doc:!1}}};var p3_window_loaded=!1,p3_loader_complete=!1;p3_window_wait="undefined"==typeof p3_window_wait?!0:p3_window_wait,p3_jquery_ui="undefined"==typeof p3_jquery_ui?!0:p3_jquery_ui,p3_external_stylesheet="undefined"==typeof p3_external_stylesheet?!1:p3_external_stylesheet,p3_hosted_extensions="undefined"==typeof p3_hosted_extensions?[]:p3_hosted_extensions,p3_extensions="undefined"==typeof p3_extensions?[]:p3_extensions,function(a,b,c,d){var e=!1,f=this,g={},h=[];this.all_loaded=function(){for(var a=0;a<h.length;a++)if(!(status=g[h[a]])&&"loaded"!=status&&"complete"!=status)return!1;return!0},this.run_script=function(){return e?!0:(P3.JQuery=jQuery.noConflict(!0),p3_jquery_ui&&P3.Util.load_remote_script("//p3.3playmedia.com/javascripts/vendor/p3-jquery-ui-1.8.16.custom.min.js"),d(P3.JQuery,e=!0),void 0)},this.load_script=function(a){h.push(a)},this.run=function(a){if(h[a]){var c=h[a],d=a,g=/\.css$/i.test(c.replace(/\?.*/,"")),i=b.createElement(g?"link":"script");if(i.type=g?"text/css":"text/javascript",g?(i.rel="stylesheet",i.href=c):i.src=c,g){var j=b.getElementsByTagName("head")[0];j=j||b.body,j.appendChild(i),f.run(d+1)}else{i.onload=i.onreadystatechange=function(){return"undefined"!=typeof i.readyState&&"complete"!=i.readyState&&"loaded"!=i.readyState?!1:void(h.length-1==d&&0==e?f.run_script():f.run(d+1))};var j=b.getElementsByTagName("head")[0];j=j||b.body,j.appendChild(i)}}else f.run_script()};var i="p3.3playmedia.com",j=[],k="/stylesheets/p3.css",l=[i+k];p3_external_stylesheet&&l.push(p3_external_stylesheet),j.push(i+"/javascripts/vendor/ejs_production.js"),j.push(i+"/javascripts/vendor/jquery-1.6.2.min.js");try{if(p3_extensions&&p3_extensions.length>0)for(var m=0;m<p3_extensions.length;m++)j.push(p3_extensions[m].replace(/^https*\:\/\//,""))}catch(n){}var o=[];for(m in P3.About.hosted_extensions)o.push(m);if(p3_hosted_extensions&&p3_hosted_extensions.length>0)for(var m=0;m<p3_hosted_extensions.length;m++)if(o.indexOf(p3_hosted_extensions[m])>=0){var p=i+"/javascripts/extensions/"+p3_hosted_extensions[m]+"/"+p3_hosted_extensions[m]+".js",q=i+"/javascripts/extensions/"+p3_hosted_extensions[m]+"/"+p3_hosted_extensions[m]+".css";j.push(p),l.push(q),p3_extensions.push(p3_hosted_extensions[m])}else console&&console.log&&console.log("Warning: P3 Hosted Extension '"+p3_hosted_extensions[m]+"' was not found.");for(var m=0;m<l.length;m++)load_script(b.location.protocol+"//"+l[m]);for(var m=0;m<j.length;m++)load_script(b.location.protocol+"//"+j[m]);this.run(0)}(window,document,"1.6.2",function(){p3_loader_complete=!0,run_p3()}),window.addEventListener?window.addEventListener("load",function(){p3_window_loaded=!0,p3_window_wait&&run_p3()},!1):window.attachEvent?window.attachEvent("onload",function(){p3_window_loaded=!0,p3_window_wait&&run_p3()}):p3_window_loaded=!0,P3.Settings={host:null,is_ssl:/https/.test(document.location.protocol),api_host:document.location.protocol+"//api.3playmedia.com",api_key:null,api_version:2,static_host:document.location.protocol+"//static.3playmedia.com",p3_host:document.location.protocol+"//p3.3playmedia.com",platform_integration:!1,debug:!1,debugger_ui:!1,domain:document.domain,major_version:"3",version:"3.3",player_tracking_interval:250},P3.Util={basename:function(a){return a.split(/[\/\\]/).slice(-1)},ms_to_stamp:function(a){var b=parseInt(a)/1e3,c=parseInt(b/60);return b%=60,b=10>b?"0"+b:b,(c+":"+b).replace(/\.\d*$/,"")},stamp_to_ms:function(a){a=a.replace(/\,/g,".");var b=a.split(/\:/),c=parseFloat(b[b.length-1]),d=parseInt(b[b.length-2],10),e=b.length>2?parseInt(b[b.length-3],10):0;return 1e3*(3600*e+60*d+c)},player_type:function(a){var b=P3.JQuery("#"+a);b.length<1&&(b=P3.JQuery("[name="+a+"]"));var c=(P3.JQuery(b).attr("name"),P3.JQuery(b).attr("class")),d=P3.JQuery(b).attr("src"),a=P3.JQuery(b).attr("id"),e=P3.JQuery(b).get(0).tagName.toLowerCase();if("iframe"==e)switch(!0){case/vimeo/i.test(c)||/vimeo/i.test(a)||/vimeo/i.test(d):return"vimeo_iframe";case/wistia/i.test(c)||/wistia/i.test(a):return"wistia_iframe"}else switch(!0){case"undefined"!=typeof b.get(0).addModelListener&&"undefined"!=b.get(0).sendEvent:return"jw";case/(player\d*?\.swf|jw)/.test(d):return"jw";case/kaltura/i.test(d)||/kaltura/i.test(a)||/kalturai/.test(c):return"kaltura";case/brightcove/i.test(c)||/brightcove/i.test(a):return"brightcove";case/wistia/i.test(c)||/wistia/i.test(a):return"wistia";case/youtube/i.test(d):return"youtube"}},params:function(a){var b=location.href.split("#");if(b.length<2)return!1;var c=b.slice(-1)[0].split("&"),d={};for(i=0;i<c.length;i++)b=c[i].split(":"),d[b[0]]=b[1];return a?d[a]||!1:d},in_array:function(a,b){for(var c=b.length,d=0;c>d;d++)if(b[d]==a)return!0;return!1},to_camel_case:function(a){return a=a.replace(/^\s+|\s+$/,""),a=a.replace(/[\-\_]([a-z])/g,function(a,b){return b.toUpperCase()}),a.charAt(0).toUpperCase()+a.slice(1)},truncate:function(a,b,c){return a.length>c-3?a.slice(0,c)+"..":a},tooltip:function(a,b,c){if(P3.Util.is_ipad())return!1;c=c||!1;var d=P3.JQuery("<div></div>");P3.JQuery(".p3-tooltip").fadeOut("fast",function(){P3.JQuery(this).remove()}),P3.JQuery(d).addClass("p3-tooltip"),c&&P3.JQuery(d).addClass(c),P3.JQuery(d).css({position:"absolute",zIndex:9999999999,top:Math.max(0,a.pageY+10),left:a.pageX+10}),P3.JQuery(d).html(b),P3.JQuery(document.body).append(d),P3.JQuery(a.target).mouseout(function(){setTimeout(function(){P3.JQuery(d).remove()},50)})},load_remote_script:function(a,b){var c=document.createElement("script");if(c.src=a,c.type="text/javascript",b){c.onload=c.onreadystatechange=function(){return"undefined"!=typeof c.readyState&&"complete"!=c.readyState&&"loaded"!=c.readyState?!1:void b()};var d=document.getElementsByTagName("script")[0];d.parentNode.insertBefore(c,d)}else P3.JQuery("script").get(0).parentNode.appendChild(c)},alert:function(a){P3.Log.error(a)},print:function(a,b){var c="toolbar=yes,location=no,directories=yes,menubar=yes,";c+="scrollbars=yes,width=750, height=600, left=100, top=25";var d=window.open("","",c);return d.document.open(),d.document.write("<html><head><title>Print Preview</title></head>"),d.document.write('<body style="padding:4px;">'),d.document.write("<p>"),d.document.write('<input type="button" onclick=javascript:window.print(); value="Print This Document"/>'),d.document.write("</p><hr/>"),d.document.write(a),d.document.write("<hr/>"),d.document.write("<p>"),d.document.write('<img src="http://p3.3playmedia.com/images/logo/interactive-transcript-logo-black.png"/>'),d.document.write("</p>"),d.document.write("</body></html>"),d.document.close(),b||d.print(),!1},selected_html:function(){try{var a;if(window.getSelection){if(a=window.getSelection(),a.getRangeAt)var b=a.getRangeAt(0);else{var b=document.createRange();b.setStart(a.anchorNode,a.anchorOffset),b.setEnd(a.focusNode,a.focusOffset)}var c=b.cloneContents(),d=c.childNodes;for(i=0;i<d.length;i++)d[i].style&&(d[i].style.backgroundColor="#fff");var e=document.createElement("div");return e.appendChild(c),e.innerHTML}return document.selection?(a=document.selection.createRange(),a.htmlText):!1}catch(f){return!1}},window_dimensions:function(){var a=630,b=460;return document.body&&document.body.offsetWidth&&(a=document.body.offsetWidth,b=document.body.offsetHeight),"CSS1Compat"==document.compatMode&&document.documentElement&&document.documentElement.offsetWidth&&(a=document.documentElement.offsetWidth,b=document.documentElement.offsetHeight),window.innerWidth&&window.innerHeight&&(a=window.innerWidth,b=window.innerHeight),{width:a,height:b}},is_ios:function(){return null!=navigator.userAgent.match(/iPad/i)||null!=navigator.userAgent.match(/iPod/i)},is_ipad:function(){return null!=navigator.userAgent.match(/iPad/i)},is_ie:function(){return P3.JQuery.browser.msie},is_ie6:function(){return P3.JQuery.browser.msie&&parseInt(P3.JQuery.browser.version)<7},is_crappy_ie:function(){return P3.JQuery.browser.msie&&parseInt(P3.JQuery.browser.version)<8},nice_searchbox:function(a){var b=a.classname||"a",c=a.placeholder||"";return setTimeout(function(){P3.JQuery.browser.webkit&&P3.JQuery("."+b).val("")},10),'<input type="text" class="p3-nice-search srch_fld '+b+'" placeholder="'+c+'" autosave="bsn_srch" results="5" />'},shorten_url:function(a,b,c){var d="3playmedia",e="R_586ba8f060b4fbccf2b5978d88f40fcc",f="http://api.bit.ly/v3/shorten?login="+d;f+="&apiKey="+e,f+="&longUrl="+encodeURIComponent(a),f+="&format=json&callback=?",P3.JQuery.getJSON(f,function(a){var d=a.data.url;c&&c(d,b)})},render_segment_map:function(a,b,c){var d=40,e=Math.min(a.total_num,d),f=Math.ceil(a.total_num/e),g=Math.ceil(a.total_num/f),h=b.video_id,j=b.file_id,k=P3.JQuery("<table></table>"),l=P3.JQuery("<tbody></tbody>"),m=P3.JQuery("<tr></tr>");P3.JQuery(l).append(m),P3.JQuery(k).append(l);var n={};for(P3.JQuery.each(a,function(a,b){n[b.number]=b.timestamp}),i=0;g>i;i++){var o=P3.JQuery("<td></td>");P3.JQuery(o).attr("num",f*i+1),P3.JQuery(o).attr("segs_per",f),P3.JQuery(o).attr("video_id",h),P3.JQuery(o).attr("file_id",j),P3.JQuery(o).html("<span>"+c+"</span>"),P3.JQuery(m).append(o)
}return P3.JQuery(m).attr("video_id",h),P3.JQuery(m).attr("file_id",j),P3.JQuery.each(a.hits,function(b){var c=Math.floor((a.hits[b].number-1)/f);P3.JQuery(k).find("td:eq("+c+")").removeClass("*").addClass("hit")}),P3.JQuery(k).html()}},P3.Cookies={set_cookie:function(a,b,c){var d=new Date;d.setDate(d.getDate()+c);var e=escape(b)+(null==c?"":"; expires="+d.toUTCString());document.cookie=a+"="+e},get_cookie:function(a){var b,c,d,e=document.cookie.split(";");for(b=0;b<e.length;b++)if(c=e[b].substr(0,e[b].indexOf("=")),d=e[b].substr(e[b].indexOf("=")+1),c=c.replace(/^\s+|\s+$/g,""),c==a)return unescape(d)}},P3.Log={log:function(a){return P3.debugger_ui&&P3.debugger_ui.logger(a),P3.Settings.debug?void("undefined"!=typeof window.console&&"undefined"!=typeof window.console.log&&console.log(a)):!1},debug:function(a){return P3.Settings.debug?void("undefined"!=typeof window.console&&"undefined"!=typeof window.console.debug&&console.debug(a)):!1},info:function(a){return P3.Settings.debug?void("undefined"!=typeof window.console&&"undefined"!=typeof window.console.info&&console.info(a)):!1},warn:function(a){return P3.Settings.debug?void("undefined"!=typeof window.console&&"undefined"!=typeof window.console.warn&&console.warn(a)):!1},error:function(a,b){return P3.Settings.debug?void("undefined"!=typeof window.console&&"undefined"!=typeof window.console.error?console.error(a):b&&b(a)):!1},object:function(a){return P3.Settings.debug?void("undefined"!=typeof window.console&&"undefined"!=typeof window.console.dir&&console.dir(a)):!1}},P3.Event=function(a){var b=this;this.instance=a,this.trigger=function(a,c){var a=a,c=c;setTimeout(function(){P3.JQuery(b.instance).trigger(a,c)},0),event_name=a.split("."),P3.Log.debug("Event Triggered: "+a),P3.debugger_ui&&P3.debugger_ui.event_logger(a,c)},this.Player={Progress:function(){}}},P3.Player=function(a,b,c){var d=this,e=P3.JQuery;this.instance=a,this.player_id=b,this.player=e("#"+b),this.interval=!1,this.last_m=-99,this.interface=!1,this.find_player_interval=setInterval(function(){if(/closest\_player/.test(b))try{var a=e("object,embed").get(0);if(a||(a=e("iframe").get(0)),!a)return!1;e(a).attr("id")||e(a).attr("id","3play_auto_id"),b=e(a).attr("id"),d.instance.player_reference=b,d.player_id=b,d.player=e("#"+b),"auto"==d.instance.settings.player_type&&(d.instance.settings.player_type=P3.Util.player_type(b))}catch(f){return!1}if("auto"==d.instance.settings.player_type&&(d.instance.settings.player_type=P3.Util.player_type(b)),c.html5_container_id&&e("#"+c.html5_container_id).find("video,audio").length>0){if(d.player=e("#"+c.html5_container_id).find("video,audio:first"),d.player_id=e(d.player).attr("id"),!d.player_id){var g="tpm_"+parseInt(1e8*Math.random());e(d.player).attr("id",g),d.player_id=g}d.instance.settings.player_type="html5",d.instance.player_reference=d.player_id}if(P3.Log.debug("Finding player with ID "+b+"..."),d.interface&&d.interface.position&&clearInterval(d.find_player_interval),!e("#"+b))return!1;var h=d.instance.settings.player_type||P3.Util.player_type(b);h=h.toLowerCase().replace(/^\s+|\s+$/,""),d.player_type=h;try{d.interface=new P3.PlayerInterface[h](d.instance.player_reference,d.instance),d.instance.event.trigger("Player.Ready",{player_id:b,player_type:h}),clearInterval(d.find_player_interval)}catch(f){P3.Log.error(f),d.interface=!1;var j=[];for(i in P3.PlayerInterface)j.push(i);if(P3.Util.in_array(h,j))return!1;P3.Util.alert("Player Type "+h+" is not supported.\nSupported Players: "+j.join(", "))}},250),this.start_tracking=function(){d.interval=setInterval(function(){if(d.interface&&d.interface.play_state&&"PLAYING"==d.interface.play_state()){var a=d.interface.position(),b=d.instance.settings.platform_integration?d.interface.video_id():!1;d.instance.event.trigger("Player.Progress",{m:a,video_id:b}),d.last_m=a}},P3.Settings.player_tracking_interval)},this.stop_tracking=function(){clearInterval(d.interval)},this.load_video=function(a){return a.video_id?(d.interface.play_file(a),m=a.m||0,d.instance.settings.file_id=a.video_id,d.instance.event.trigger("Player.VideoLoad",{video_id:a.video_id,m:m}),void 0):!1},e(a).bind("Player.Ready",function(){!d.onload_seek_handled&&P3.Util.params("p3s")&&(!P3.Util.params("p3i")||P3.Util.params("p3i")==d.instance.instance_index)&&(d.ready_to=setInterval(function(){return d.interface&&d.interface.play?(d.interface.play(),void clearInterval(d.ready_to)):!1},10))}),e(a).bind("Player.Progress",function(a,b){if(d.onload_seek_handled||!P3.Util.params("p3s")||P3.Util.params("p3i")&&P3.Util.params("p3i")!=d.instance.instance_index)if(d.play_video_id)d.play_video_id!=d.interface.video_id()&&d.interface.play_file({video_id:d.play_video_id}),d.play_video_id=!1;else if(d.seek_to_m&&"PLAYING"==d.interface.play_state()){if(d.instance.player.seek_to_video_id){if(d.instance.player.seek_to_video_id!=d.instance.player.interface.video_id())return!1;d.instance.player.seek_to_video_id=!1}d.interface.seek(d.seek_to_m),d.seek_to_m=!1}else d.pause_at_m&&d.pause_at_m<b.m-1e3&&(d.interface.pause(),d.pause_at_m=!1);else{var c=parseInt(P3.Util.params("p3s"),10);d.onload_seek_handled=!0,d.interface.play(),d.play_video_id=P3.Util.params("p3v")||!1,d.seek_to_m=c,d.pause_at_m=P3.Util.params("p3e")||!1}}),this.start_tracking()},P3.PlayerInterface={brightcove:function(a,b){if(brightcove&&brightcove.api&&brightcove.api.getExperience(a)){var c=this;if(c.instance=b,this.bcExp=brightcove.api.getExperience(a),this.modVP=this.bcExp.getModule(brightcove.api.modules.APIModules.VIDEO_PLAYER),this.modExp=this.bcExp.getModule(brightcove.api.modules.APIModules.EXPERIENCE),this.modCon=this.bcExp.getModule(brightcove.api.modules.APIModules.CONTENT),!this.modVP.addEventListener)throw"not_ready";this.modVP.addEventListener(brightcove.api.events.MediaEvent.PROGRESS,function(a){c.player_info.position=parseInt(1e3*parseFloat(a.position),10),c.player_info.videoid=a.media.id}),this.player_info={position:0,is_playing:!1},this.play=function(){return this.modVP.play()},this.pause=function(){return this.modVP.pause()},this.play_state=function(){return this.modVP.getIsPlaying(function(a){c.player_info.is_playing=a}),c.player_info.is_playing?"PLAYING":"PAUSED"},this.position=function(){return this.player_info.position},this.duration=function(){return this.modVP.getVideoDuration(function(a){c.player_info.duration=1e3*a}),c.player_info.duration||!1},this.video_id=function(){return this.modVP.getCurrentVideo(function(a){c.player_info.videoid=a.id}),c.player_info.videoid||!1},this.seek=function(a){"PAUSED"==this.play_state()?(this.play(),setTimeout(function(){c.modVP.seek(parseInt(a/1e3,10))},100)):this.modVP.seek(parseInt(a/1e3,10))},this.play_file=function(a){a.video_id!=this.video_id()?(this.modVP.loadVideoByID(a.video_id),c.instance.player.seek_to_m=a.m||0,c.instance.player.seek_to_video_id=a.video_id):this.seek(a.m)}}else{if(!brightcove||!brightcove.getExperience(a))throw"not_ready";var c=this;if(c.instance=b,this.bcExp=brightcove.getExperience(a),this.modVP=this.bcExp.getModule(APIModules.VIDEO_PLAYER),this.modExp=this.bcExp.getModule(APIModules.EXPERIENCE),this.modCon=this.bcExp.getModule(APIModules.CONTENT),!this.modVP.addEventListener)throw"not_ready";this.modVP.addEventListener(BCMediaEvent.PLAY,function(){}),this.modVP.addEventListener(BCMediaEvent.STOP,function(){}),this.modVP.addEventListener(BCMediaEvent.BEGIN,function(){}),this.modVP.addEventListener(BCMediaEvent.PROGRESS,function(a){c.player_info.position=parseInt(1e3*parseFloat(a.position),10),c.player_info.videoid=a.media.id}),this.modExp.addEventListener(BCExperienceEvent.CONTENT_LOAD,function(){}),this.player_info={position:0},this.play=function(){return this.modVP.play()},this.pause=function(){return this.modVP.pause()},this.play_state=function(){return this.modVP.isPlaying()?"PLAYING":"PAUSED"},this.position=function(){return this.player_info.position},this.duration=function(){return 1e3*this.modVP.getVideoDuration()},this.video_id=function(){return this.modVP.getCurrentVideo().id},this.seek=function(a){"PAUSED"==this.play_state()?(this.play(),setTimeout(function(){c.modVP.seek(parseInt(a/1e3,10))},100)):this.modVP.seek(parseInt(a/1e3,10))},this.play_file=function(a){a.video_id!=this.video_id()?(this.modVP.loadVideo(a.video_id),c.instance.player.seek_to_m=a.m||0,c.instance.player.seek_to_video_id=a.video_id):this.seek(a.m)}}},delve:function(a,b){var c=this;if(c.instance=b,"undefined"==typeof DelvePlayer)throw"not_ready";this.delve_id=a,DelvePlayer.registerPlayer(a),this.delve_player=function(){var a=DelvePlayer.getPlayers(c.delve_id)[0];return"string"==typeof a?document.getElementById(a):a},this.play=function(){c.delve_player().doPlay()},this.pause=function(){c.delve_player().doPause()},this.play_state=function(){return c.delve_player().doGetCurrentPlayState().isPlaying?"PLAYING":"PAUSED"},this.position=function(){return c.delve_player().doGetPlayheadPositionInMilliseconds()},this.duration=function(){return c.delve_player().doGetCurrentMedia().durationInMilliseconds},this.video_id=function(){return c.delve_player().doGetCurrentMedia().id},this.seek=function(a){c.delve_player().doSeekToSecond(a/1e3)},this.play_file=function(a){a.video_id!=this.video_id()?(c.delve_player().doLoadMedia(a.video_id,!0),c.instance.player.seek_to_m=a.m||0,c.instance.player.seek_to_video_id=a.video_id):this.seek(a.m)}},flowplayer:function(a,b){var c=this;return c.instance=b,"undefined"==typeof flowplayer?!1:(this.flow_player=a,this.play=function(){return flowplayer(this.flow_player).play()},this.pause=function(){return flowplayer(this.flow_player).pause()},this.play_state=function(){var a=flowplayer(this.flow_player).getState();switch(a){case 3:return"PLAYING";default:return"PAUSED"}},this.position=function(){return 1e3*flowplayer(this.flow_player).getTime()},this.duration=function(){return 1e3*parseFloat(flowplayer(this.flow_player).getClip().fullDuration())},this.video_id=function(){return flowplayer(this.flow_player).getClip().url.replace(/^.+?\:/,"")},this.seek=function(a){var b=Math.max(0,a/1e3-1);flowplayer(this.flow_player).seek(b)},void 0)},jw:function(a,b){var c=this;if(c.instance=b,"undefined"!=typeof jwplayer&&jwplayer(a)&&jwplayer(a).play)this.jw_player=jwplayer(a),this.play=function(){c.jw_player.play()},this.pause=function(){c.jw_player.pause()},this.play_state=function(){return"PLAYING"==c.jw_player.getState()?"PLAYING":"PAUSED"},this.position=function(){return 1e3*c.jw_player.getPosition()},this.duration=function(){return 1e3*c.jw_player.getDuration()},this.video_id=function(){try{var a=c.jw_player.getPlaylistItem().sources[0].file.split("/").slice(-1)[0];return a}catch(b){return""}},this.seek=function(a){c.jw_player.seek(a/1e3)};else{if(!window.document[a]||"undefined"==typeof window.document[a].addModelListener)return!1;this.jw_player=window.document[a],p3_jw_interfaces[a]=new PlayerInterfaceExtension_JW(this),this.jw_player.addModelListener("STATE",'p3_jw_interfaces["'+a+'"].play_handler'),this.jw_player.addModelListener("TIME",'p3_jw_interfaces["'+a+'"].playhead_handler'),this.play=function(){c.jw_player.sendEvent("PLAY","true")},this.pause=function(){c.jw_player.sendEvent("PLAY","false")},this.play_state=function(){return this.player_state},this.position=function(){return this.playhead_time},this.duration=function(){return 1e3*this.jw_player.getPlaylist()[c.jw_player.getConfig().item].duration},this.video_id=function(){var a=this.jw_player.getPlaylist()[c.jw_player.getConfig().item].file;return a.split(/\//).slice(-1)[0].replace(/\-.*$/,"")},this.seek=function(a){var b=parseInt(a,10)/1e3;b=Math.max(0,b-1),c.jw_player.sendEvent("SEEK",b)}}},kaltura:function(a,b){var c=this;return c.instance=b,this.kaltura_player=P3.JQuery("#"+a).get(0),this.kaltura_player&&this.kaltura_player.addJsListener?(this.player_state=!1,this.playhead_time=0,this.player_id=a,p3_kaltura_interfaces[c.player_id]=new PlayerInterfaceExtension_Kaltura(c),c.kaltura_player.addJsListener("playerPlayed",'p3_kaltura_interfaces["'+c.player_id+'"].play_handler'),c.kaltura_player.addJsListener("playerPaused",'p3_kaltura_interfaces["'+c.player_id+'"].pause_handler'),c.kaltura_player.addJsListener("playerPlayEnd",'p3_kaltura_interfaces["'+c.player_id+'"].pause_handler'),c.kaltura_player.addJsListener("playerUpdatePlayhead",'p3_kaltura_interfaces["'+c.player_id+'"].playhead_handler'),this.play=function(){this.kaltura_player.sendNotification("doPlay")},this.pause=function(){this.kaltura_player.sendNotification("doPause")},this.play_state=function(){return this.player_state},this.position=function(){return this.playhead_time},this.duration=function(){return this.kaltura_player.evaluate("{mediaProxy.entry.msDuration}")},this.video_id=function(){return this.kaltura_player.evaluate("{mediaProxy.entry.id}")},this.seek=function(a){this.kaltura_player.sendNotification("doSeek",parseFloat(parseInt(a)/1e3))},this.play_file=function(a){if(a.video_id!=this.video_id()){var b=a.m||0;this.kaltura_player.sendNotification("changeMedia",{entryId:a.video_id,seekFromStart:b.toString()}),this.timer=setInterval(function(){return"PLAYING"==c.play_state()&&c.video_id()==a.video_id?(clearInterval(c.timer),!0):void c.play()},200)}else this.seek(a.m)},void 0):!1},mediaplatform:function(a,b){var c=this;return c.instance=b,this.mp_player=$MP("#"+a),this.mp_player?(this.play=function(){this.mp_player.video("play")},this.pause=function(){this.mp_player.video("pause")},this.play_state=function(){return this.mp_player.video("status")==PLAYER_PLAYING?"PLAYING":"PAUSED"},this.position=function(){return this.mp_player.video("currentTime")},this.duration=function(){return this.mp_player.video("duration")},this.seek=function(a){this.mp_player.video("currentTime",a)},this.video_id=function(){return!1},this.play_file=function(){return!1},void 0):!1},ooyala:function(a,b){var c=this;if(c.instance=b,window[a]&&"undefined"!=typeof window[a].play)this.play=function(){window[a].play()},this.pause=function(){window[a].pause()},this.play_state=function(){return"playing"==window[a].state?"PLAYING":"PAUSED"},this.position=function(){return parseInt(1e3*(window[a].playheadTime||0),10)},this.duration=function(){return parseInt(1e3*window[a].getDuration(),10)},this.seek=function(b){var b=parseInt(b,10)/1e3;window[a].setPlayheadTime(b)},this.video_id=function(){return window[a].embedCode},this.play_file=function(b){b.video_id!=c.video_id()?(m=b.m||0,window[a].setEmbedCode(b.video_id),c.instance.player.seek_to_m=m,c.instance.player.seek_to_video_id=b.video_id):c.seek(b.m)};else if(P3.Util.is_ipad()){if(this.ooyala_player=P3.JQuery(".OoyalaHtml5VideoPlayer").get(0),!this.ooyala_player)return!1;this.ooyala_player=function(){return P3.JQuery(".OoyalaHtml5VideoPlayer").get(0)},this.ooyala_video_tag=function(){return P3.JQuery(this.ooyala_player()).find("video:first").get(0)},this.play=function(){this.ooyala_player().playMovie()},this.pause=function(){this.ooyala_player().pauseMovie()},this.play_state=function(){return this.ooyala_video_tag().paused?"PAUSED":"PLAYING"},this.position=function(){return parseInt(1e3*this.ooyala_video_tag().currentTime,10)},this.duration=function(){return parseInt(1e3*this.ooyala_video_tag().duration,10)},this.video_id=function(){return this.ooyala_player().getEmbedCode()},this.seek=function(a){var a=parseInt(a,10)/1e3;a=Math.max(0,a-1),this.ooyala_video_tag().currentTime=a},this.play_file=function(a){a.video_id!=c.video_id()?(m=a.m||0,this.ooyala_player().setQueryStringParameters({embedCode:a.video_id,autoplay:1}),c.instance.player.seek_to_m=m,c.instance.player.seek_to_video_id=a.video_id):this.seek(a.m)}}else{if(!p3_ooyala_interfaces[a])return!1;this.ooyala_player=window.document[a],this.playhead_time=0,this.total_time=0,this.play=function(){this.ooyala_player.playMovie()},this.pause=function(){this.ooyala_player.pauseMovie()},this.play_state=function(){return this.ooyala_player.getState().toUpperCase()},this.position=function(){return this.playhead_time},this.duration=function(){return this.total_time},this.video_id=function(){return this.ooyala_player.getCurrentItemEmbedCode()},this.seek=function(a){var b=Math.max(0,parseInt(a,10)/1e3-1);this.ooyala_player.setPlayheadTime(b)},this.play_file=function(a){a.video_id!=c.video_id()?(m=a.m||0,this.ooyala_player.setQueryStringParameters({embedCode:a.video_id,autoplay:1}),c.instance.player.seek_to_m=m,c.instance.player.seek_to_video_id=a.video_id):this.seek(a.m)}}},video_js:function(a,b){var c=this;return c.instance=b,this.player_id=a,"undefined"==typeof _V_?!1:(this.play=function(){_V_(a).play()},this.pause=function(){_V_(a).pause()},this.play_state=function(){return _V_(a).paused()?"PAUSED":"PLAYING"},this.position=function(){return 1e3*_V_(a).currentTime()},this.duration=function(){return 1e3*_V_(a).duration()},this.video_id=function(){return!1},this.seek=function(b){var d=parseInt(b,10)/1e3;_V_(a).currentTime(d),c.play()},this.play_file=function(){return!1},void 0)},vimeo:function(a,b){var c=this;return c.instance=b,this.player_state=!1,this.playhead_time=0,this.vimeo_player=document.getElementById(a),"undefined"==typeof this.vimeo_player||"undefined"==typeof this.vimeo_player.api_addEventListener?!1:(p3_vimeo_interfaces[a]=new PlayerInterfaceExtension_Vimeo(this),this.vimeo_player.api_addEventListener("onPlay",'p3_vimeo_interfaces["'+a+'"].play_handler'),this.vimeo_player.api_addEventListener("onPause",'p3_vimeo_interfaces["'+a+'"].pause_handler'),this.vimeo_player.api_addEventListener("onLoading",'p3_vimeo_interfaces["'+a+'"].pause_handler'),this.vimeo_player.api_addEventListener("onFinish",'p3_vimeo_interfaces["'+a+'"].pause_handler'),this.vimeo_player.api_addEventListener("onProgress",'p3_vimeo_interfaces["'+a+'"].playhead_handler'),this.play=function(){this.vimeo_player.api_play()},this.pause=function(){this.vimeo_player.api_pause()},this.play_state=function(){return this.player_state},this.position=function(){return this.playhead_time},this.duration=function(){return this.vimeo_player.api_getDuration()},this.video_id=function(){try{var a=P3.JQuery(this.vimeo_player).find("param[name=flashVars]").val();return a.match(/clip\_id\=(\d+)\&*/)[1]}catch(b){return null}},this.seek=function(a){var b=Math.max(0,a/1e3-1);this.vimeo_player.api_seekTo(b)},void 0)},vimeo_iframe:function(a,b){var c=this;return c.instance=b,this.vimeo_player_id=a,"undefined"==typeof $f?!1:(this.vimeo_player=$f(a),this.vimeo_player?(this.playhead_time=0,this.player_state="PAUSED",this.duration=!1,p3_vimeo_iframe_interfaces[a]=new PlayerInterfaceExtension_VimeoIframe(this),this.vimeo_player.addEvent("play",function(a){p3_vimeo_iframe_interfaces[c.vimeo_player_id].play_handler(a)}),this.vimeo_player.addEvent("onPause",function(a){p3_vimeo_iframe_interfaces[c.vimeo_player_id].pause_handler(a)}),this.vimeo_player.addEvent("onLoading",function(a){p3_vimeo_iframe_interfaces[c.vimeo_player_id].pause_handler(a)}),this.vimeo_player.addEvent("onFinish",function(a){p3_vimeo_iframe_interfaces[c.vimeo_player_id].pause_handler(a)}),this.vimeo_player.addEvent("playProgress",function(a,b){p3_vimeo_iframe_interfaces[c.vimeo_player_id].playhead_handler(a,b)}),this.play=function(){c.vimeo_player.api("play")},this.pause=function(){c.vimeo_player.api("pause")},this.play_state=function(){return this.player_state},this.position=function(){return this.playhead_time||0},this.duration=function(){return c.duration?duration:void c.vimeo_player.get("getDuration",function(a){c.duration=a})},this.seek=function(a){var b=Math.max(0,a/1e3-1);c.vimeo_player.api("seekTo",b)},this.video_id=function(){try{var a=c.vimeo_player.element.src.split("/").slice(-1)[0].replace(/\?.*/,"");return a}catch(b){return!1}},void 0):!1)},wistia:function(a,b){var c=this;c.instance=b,this.wistia_player=window.document[a],("undefined"==typeof this.wistia_player||"undefined"==typeof this.wistia_player.videoPlay)&&(this.wistia_player=P3.JQuery("embed[name="+a+"]")),("undefined"==typeof this.wistia_player||"undefined"==typeof this.wistia_player.videoPlay)&&(this.wistia_player=P3.JQuery("#"+a).find("embed").get(0)),("undefined"==typeof this.wistia_player||"undefined"==typeof this.wistia_player.videoPlay)&&(this.wistia_player=P3.JQuery("#"+a).find("object").get(0)),this.play=function(){c.wistia_player.videoPlay()},this.pause=function(){c.wistia_player.videoPause()},this.play_state=function(){return 1==c.wistia_player.getCurrentState()?"PLAYING":"PAUSED"},this.position=function(){return 1e3*c.wistia_player.getCurrentTime()},this.duration=function(){return 1e3*parseInt(c.wistia_player.getDuration())},this.video_id=function(){return!1},this.seek=function(a){var b=(a-2500)/1e3;c.wistia_player.videoSeek(Math.max(0,b))}},wistia_iframe:function(a,b){var c=this;return c.instance=b,this.wistia_player=document.getElementById(a),"undefined"==typeof this.wistia_player?!1:"undefined"==typeof this.wistia_player.wistiaApi?!1:(this.play=function(){c.wistia_player.wistiaApi.play()},this.pause=function(){c.wistia_player.wistiaApi.pause()},this.play_state=function(){return"playing"==c.wistia_player.wistiaApi.state().toLowerCase()?"PLAYING":"PAUSED"},this.position=function(){return 1e3*c.wistia_player.wistiaApi.time()},this.duration=function(){return 1e3*c.wistia_player.wistiaApi.duration()},this.video_id=function(){return!1},this.seek=function(a){var b=a/1e3;c.wistia_player.wistiaApi.time(b).play()},void 0)},youtube:function(a,b){var c=this;if(c.instance=b,document.getElementById(a)&&"iframe"==document.getElementById(a).tagName.toLowerCase()){if("undefined"==typeof YT||"undefined"==typeof YT.Player)throw"not_ready";if(!YT.loaded)throw"not_ready";if(c.instance.ytplayerloaded)return!1;c.youtube_player=new YT.Player(a),c.instance.ytplayerloaded=!0}else this.youtube_player=window.document[a];this.play=function(){this.youtube_player.playVideo()},this.pause=function(){this.youtube_player.pauseVideo()},this.play_state=function(){try{var a=this.youtube_player.getPlayerState()}catch(b){return"PAUSED"}return 1==parseInt(a)||5==parseInt(a)?"PLAYING":"PAUSED"},this.position=function(){return parseInt(1e3*this.youtube_player.getCurrentTime()+.5)},this.duration=function(){return this.youtube_player?parseInt(1e3*this.youtube_player.getDuration()+.5):!1},this.video_id=function(){try{var a=this.youtube_player.getVideoUrl().replace(/^[^v]+v.(.{11}).*/,"$1");return a}catch(b){return null}},this.seek=function(a){var a=parseInt(a,10)/1e3;this.youtube_player.seekTo(a)},this.play_file=function(a){var b=a.video_id,d=a.m||0;if(d=parseInt(d,10),!b)return!1;if(b!=this.video_id())try{this.youtube_player.loadVideoById(b),c.instance.player.seek_to_m=d,c.instance.player.seek_to_video_id=b}catch(e){}else this.play(),this.seek(d)}},soundcloud:function(a,b){var c=this;return c.instance=b,c.player_id=a,SC&&SC.Widget&&SC.Widget(a)?(c.player_position=0,c.player_state="PAUSED",c.player_video_id=!1,c.player_duration=!1,SC.Widget(c.player_id).bind("playProgress",function(a){c.player_position=a.currentPosition,c.player_state="PLAYING"}),SC.Widget(c.player_id).bind("pause",function(){c.player_state="PAUSED"}),SC.Widget(c.player_id).bind("finish",function(){c.player_state="PAUSED"}),this.play=function(){SC.Widget(c.player_id).play()},this.pause=function(){SC.Widget(c.player_id).pause()},this.play_state=function(){return c.player_state},this.position=function(){return c.player_position},this.duration=function(){return c.player_duration},this.video_id=function(){return c.player_video_id},this.seek=function(a){SC.Widget(c.player_id).seekTo(a)},this.load_meta=function(){SC.Widget(c.player_id).getCurrentSound(function(a){c.player_duration=a.duration,c.player_video_id=a.id}),SC.Widget(c.player_id).get},this.load_meta(),void 0):!1},soundmanager2:function(a,b){var c=this;if(c.instance=b,!(soundManager&&soundManager.soundIDs.indexOf(a)>=0))return!1;var d=soundManager.getSoundById(a);this.play=function(){d.play()},this.pause=function(){d.pause()},this.play_state=function(){return 1==d.playState&&0==d.paused?"PLAYING":"PAUSED"},this.position=function(){return d.position},this.duration=function(){return d.duration},this.video_id=function(){return d.url.split("/").slice(-1)[0]},this.seek=function(a){d.setPosition(a)}},sublime:function(a,b){var c=this;return c.instance=b,"undefined"==typeof sublime||"undefined"==typeof sublime.player?!1:"undefined"==typeof sublime.player(a)?!1:(c.player_id=a,c.player_state=!1,sublime.player(c.player_id).on({start:function(){c.player_state="PLAYING"},end:function(){c.player_state="PAUSED"},timeUpdate:function(){c.player_state="PLAYING"},stop:function(){c.player_state="PAUSED"},pause:function(){c.player_state="PAUSED"},play:function(){c.player_state="PLAYING"}}),this.play=function(){sublime.player(c.player_id).play()},this.pause=function(){sublime.player(c.player_id).pause()},this.play_state=function(){return c.player_state},this.position=function(){return 1e3*sublime.player(c.player_id).playbackTime()},this.duration=function(){return parseInt(1e3*sublime.player(c.player_id).duration(),10)},this.video_id=function(){return!1},this.seek=function(a){var b=a/1e3;sublime.player(c.player_id).seekTo(b)},void 0)},html5:function(a,b){var c=this;c.instance=b;var d=P3.JQuery("#"+a);return 0==d.length?!1:("video"!=d.get(0).tagName.toLowerCase()&&(d=P3.JQuery(d).find("video,audio")),this.html5_player=d.get(0),"undefined"!=typeof this.html5_player&&"undefined"!=typeof this.html5_player.play&&(this.play=function(){this.html5_player.play()},this.pause=function(){this.html5_player.pause()},this.play_state=function(){return this.html5_player.paused?"PAUSED":"PLAYING"},this.position=function(){return parseInt(1e3*this.html5_player.currentTime,10)},this.duration=function(){return parseInt(1e3*this.html5_player.duration,10)},this.video_id=function(){return!1},this.seek=function(a){var a=parseInt(a,10)/1e3;a=Math.max(0,a-1),this.html5_player.currentTime=a}),void 0)}};var p3_ooyala_interfaces={},p3_kaltura_interfaces={};PlayerInterfaceExtension_Kaltura=function(a){var b=this;this.player_interface=a,this.kaltura_player_id=a.kaltura_player.id,this.play_handler=function(){b.player_interface.player_state="PLAYING"},this.pause_handler=function(){b.player_interface.player_state="PAUSED"},this.playhead_handler=function(a){b.player_interface.playhead_time=1e3*parseFloat(a)}};var p3_jw_interfaces={};PlayerInterfaceExtension_JW=function(a){var b=this;this.player_interface=a,this.jw_player_id=a.jw_player.id,this.play_handler=function(a){b.player_interface.player_state="PLAYING"==a.newstate?"PLAYING":"PAUSED"},this.playhead_handler=function(a){b.player_interface.playhead_time=1e3*parseFloat(a.position)}};var p3_vimeo_interfaces={};PlayerInterfaceExtension_Vimeo=function(a){var b=this;this.player_interface=a,this.vimeo_player_id=a.vimeo_player.id,this.play_handler=function(){b.player_interface.player_state="PLAYING"},this.pause_handler=function(){b.player_interface.player_state="PAUSED"},this.playhead_handler=function(a){b.player_interface.player_state="PLAYING",b.player_interface.playhead_time=1e3*parseFloat(a)}};var p3_vimeo_iframe_interfaces={};PlayerInterfaceExtension_VimeoIframe=function(a){var b=this;this.player_interface=a,this.vimeo_player_id=a.vimeo_player.id,this.play_handler=function(){b.player_interface.player_state="PLAYING"},this.pause_handler=function(){b.player_interface.player_state="PAUSED"},this.playhead_handler=function(a){b.player_interface.player_state="PLAYING",b.player_interface.playhead_time=1e3*parseFloat(a.seconds)}},P3.Transcript=function(instance,options){var $=P3.JQuery,parent=this;this.instance=instance,this.file={},this.cache_id=parseInt(1e6*Math.random()),this.transcript_cache={},this.stemmer=!1,this.skin_dependencies={hot_pink:"basic_color",blue_pro:"basic_color",cardinal_red:"basic_color",zesty_orange:"basic_color",darth_gecko:"gecko",sunburst:"basic_textured",wood:"basic_textured",metallic:"basic_textured",ice:"frost"},this.settings={skin:"frost",ie6_skin:"ice",width:"400px",height:"400px",file_id:!1,can_print:!1,can_download:!1,can_clip:!1,can_collapse:!1,collapse_label:"",expand_label:"",vertical_collapse:!1,scan_view:!1,scan_view_buffer:50,collapse_onload:!1,hide_onerror:!1,track_alt:!1,progressive_tracking:!1,track_highlighted_words:!1,keyup_search:!1,transcript_search_offset:3e3,transcript_versions:!1,transcript_url:!1,transcript_url_convention:!1,cross_domain_loader:!1,cross_domain_dynamic_callback:!1,search_transcript_stemming:!0,search_placeholder:"Search Video",transcript_offset:!1,transcript_start:!1,transcript_end:!1,locked:!0,global_unlock:!1,light_scroll:!1,template:"default",api_key:!1},this.init=function(){if($.each(options.transcript,function(a){parent.settings[a]=options.transcript[a]}),!parent.settings.target)return!1;if(parent.settings.file_id||(parent.settings.file_id=parent.instance.settings.file_id),parent.settings.api_key||(parent.settings.api_key=P3.Settings.api_key),P3.Util.is_ie6()&&parent.settings.ie6_skin&&(parent.settings.skin=parent.settings.ie6_skin),parent.settings.search_transcript_stemming){var a=/https/i.test(document.location.protocol)?"https://s3.amazonaws.com/origin-p3.3playmedia.com":"http://p3.3playmedia.com";P3.Util.load_remote_script(a+"/javascripts/vendor/Snowball.min.js")}this.render(),this.listen()},this.die=function(){$(this.transcript_container).find("span").die("click"),$(this.transcript_container).die("click"),$(this.container).find("a").die("click"),$(this.container).find(".print").die("click"),$(this.container).find(".download").die("click"),$(this.container).find(".scan-view").die("click"),$(this.container).find(".p3-timeline").die("click"),$(this.container).find(".pointer").die("click"),$(this.container).find(".pointer").die("mouseover"),$(this.container).find(".p3-transcript-button").die("click"),$(this.container).find(".p3-transcript-button").die("mouseover"),$(this.container).children().remove(),parent.instance.event.trigger("Transcript.Die")},this.container=$("#"+options.transcript.target),this.transcript_container={},this.render=function(){var a=parent.templates[parent.settings.template]?parent.settings.template:"default",b=new EJS({text:parent.templates[a],type:"["}).render(parent.settings);$(this.container).html(b),parent.transcript_container=$(this.container).find(".p3-transcript-main"),parent.apply_skin(),P3.Util.is_ie()&&(parent.settings.width=parseInt(parent.settings.width,10)+2+"px",parent.settings.height=parseInt(parent.settings.height,10)+2+"px"),$(this.container).find(".p3-transcript-container").css({width:parent.settings.width,height:parent.settings.height}),$(this.container).find("input[type=text]").each(function(){var a=$(this).val();$(this).attr("oval",a)}),this.resolve_transcript_height(),this.transcript_request(),parent.settings.can_collapse&&parent.settings.collapse_label&&$(parent.container).find(".p3-transcript-button.collapse").addClass("visible-label"),parent.settings.can_collapse&&parent.settings.collapse_onload&&parent.collapse(),parent.instance.event.trigger("Transcript.TemplateRendered")},this.listen=function(){$(this.container).find("input[type=text]").live("click",function(){$(this).val()==$(this).attr("oval")&&$(this).val("")}),$(this.container).find(".p3-transcript-search").live("keyup",function(a){var b=a.keyCode||a.which;27==b&&($(this).val(""),parent.search_transcript("")),parent.settings.keyup_search&&(parent.keyup_search_timeout&&clearTimeout(parent.keyup_search_timeout),parent.keyup_search_timeout=setTimeout(function(){var a=$(parent.container).find(".p3-transcript-search").val();parent.search_transcript(a,"topbar_search")},333))}),$(this.container).find(".p3-transcript-bottom-search-submit").live("click",function(){var a=$(parent.container).find(".p3-transcript-bottom-search").val();parent.search_transcript(a,"bottombar_search")}),$(this.container).find(".p3-transcript-bottom-search").live("keyup",function(a){var b=a.keyCode||a.which;if(27==b)$(this).val(""),parent.search_transcript("");else if(13==b){var c=$(this).val();parent.search_transcript(c,"bottombar_search")
}parent.settings.keyup_search&&(parent.keyup_search_timeout&&clearTimeout(parent.keyup_search_timeout),parent.keyup_search_timeout=setTimeout(function(){var a=$(parent.container).find(".p3-transcript-bottom-search").val();parent.search_transcript(a,"bottombar_search")},333))}),$(this.container).find(".p3-transcript-searchform").submit(function(){var a=$(this).find(".p3-transcript-search").val();return parent.search_transcript(a),!1}),$(this.container).find(".p3-transcript-search-reset").live("click",function(){$(parent.container).find(".p3-transcript-search,.p3-transcript-bottom-search").val(""),parent.search_transcript("")}),$(this.container).find(".p3-bottombar-reset-search").live("click",function(){parent.search_transcript(""),$(parent.container).find(".p3-transcript-bottom-search").val("")}),$(this.container).find(".print").live("click",function(){parent.print_transcript()}),$(this.container).find(".download").live("click",function(){location.href=parent.download_url()}),$(this.container).find(".scan-view").live("click",function(){var a=$(this).find("span").html();"Scan View"==a?(parent.load_scan_view(),$(this).find("span").html("Loading")):(parent.clear_scan_view(),$(this).find("span").html("Scan View"))}),$(this.container).find(".p3-timeline,.p3-bottombar-timeline").live("click",function(a){var b=(a.offsetX||a.layerX)/$(this).outerWidth(),c=b*parent.file.duration;parent.instance.player.interface.seek(c)}),$(this.container).find(".pointer").live("click",function(){var a=parseInt($(this).attr("m"),10)-parent.settings.transcript_search_offset;return parent.instance.player.interface.seek(a),!1}),$(this.container).find(".pointer").live("mouseover",function(e){for(var next_word=$(parent.transcript_container).find("span[m="+$(this).attr("m")+"]"),msg=[],counter=0;next_word.length>0&&7>counter;)msg.push($(next_word).html()),counter+=1,next_word=$(next_word).next();var re=eval("/("+parent.saved_search_term+")/gi");P3.Util.tooltip(e,msg.join(" ").replace(re,"<b>$1</b>"),parent.settings.skin)}),$(this.container).find(".p3-transcript-button").live("click",function(){$(this).hasClass("locked")?($(this).removeClass("locked"),$(this).addClass("unlocked"),$(this).find("span").html("Lock"),parent.settings.locked=!1,parent.settings.global_unlock=!0):$(this).hasClass("unlocked")&&($(this).removeClass("unlocked"),$(this).addClass("locked"),$(this).find("span").html("Unlock"),parent.settings.locked=!0,parent.settings.global_unlock=!1)}),$(this.container).find(".p3-transcript-button").live("mouseover",function(a){var b=!1,c=$(a.target);switch(!0){case c.hasClass("print"):b="Print Transcript";break;case c.hasClass("download"):b="Download Transcript";break;case c.hasClass("locked"):b="Disable Transcript Auto-Scrolling";break;case c.hasClass("unlocked"):b="Enable Transcript Auto-Scrolling";break;case c.hasClass("collapse"):b="Hide Interactive Transcript";break;case c.hasClass("expand"):b="View Interactive Transcript";break;case c.hasClass("clip-inactive"):b="Highlight Text to Share Clips";break;case c.hasClass("clip-active"):b="Share Highlighted Clip"}0!=b&&P3.Util.tooltip(a,b)}),$(this.transcript_container).live("click",function(a){var b=a.target;if("span"!=b.tagName.toLowerCase())return!1;var c=$(b).attr("m"),d=$(b).html();parent.instance.event.trigger("Transcript.WordClick",{m:c,word:d,current_m:parent.instance.player.interface.position()}),parent.instance.player.interface.seek(c)}),$(this.transcript_container).mouseover(function(){parent.settings.locked=!1}),$(this.transcript_container).mouseout(function(){parent.settings.locked=!0}),$(this.transcript_container).mousedown(function(){parent.settings.can_clip&&$(parent.container).find(".clip-active").removeClass("clip-active").addClass("clip-inactive")}),$(this.transcript_container).mouseup(function(){parent.handle_selected_text()}),$(this.container).find(".collapse").live("click",function(){parent.collapse()}),$(this.container).find(".expand").live("click",function(){parent.expand()}),$(this.container).find(".p3-transcript-versions").change(function(){var a=$(this).val().replace(/^\s+|\s+$/,"");parent.settings.transcript_url=a,parent.transcript_request()}),$(this.container).find(".p3-close-social-sharing").live("click",function(){return $(parent.container).find(".p3-social-sharing").remove(),!1}),$(this.container).find(".clip-active").live("click",function(){parent.start_clip_share()}),$(this.container).find(".p3-tweet-clip").live("click",function(a){parent.tweet_clip(parent.settings.current_clip_selection,a)}),$(this.container).find(".p3-facebook-clip").live("click",function(a){parent.facebook_clip(parent.settings.current_clip_selection,a)}),$(this.container).find(".p3-get-shortened-link").live("click",function(a){parent.get_shortened_link(parent.settings.current_clip_selection,a)})},this.collapse=function(){var a=$(this.container).find(".collapse");a.addClass("expand"),a.removeClass("collapse"),parent.settings.expand_label&&a.find("span").html(parent.settings.expand_label),$(parent.container).find(".p3-transcript-main, .p3-transcript-controller, .p3-transcript-mediabar").hide();var b=$(parent.container).find(".p3-transcript-container").height();$(parent.container).find(".p3-transcript-container").attr("cache-height",b),$(parent.container).find(".p3-transcript-container").css("height","auto"),$(parent.container).find(".scan-view").hide(),parent.instance.event.trigger("Transcript.Collapse")},this.expand=function(){var a=$(this.container).find(".expand");a.removeClass("expand"),a.addClass("collapse"),parent.settings.collapse_label&&a.find("span").html(parent.settings.collapse_label),$(parent.container).find(".p3-transcript-main, .p3-transcript-controller, .p3-transcript-mediabar").show(),$(parent.container).find(".p3-transcript-container").css("height",$(this).attr("cache-height")),$(parent.container).find(".scan-view").show(),parent.instance.event.trigger("Transcript.Expand")},this.apply_skin=function(a){if(a=a||parent.settings.skin,a=parent.skin_dependencies[a]?parent.skin_dependencies[a]+" "+a:a){var b=$(this.container).find(".p3-transcript-container"),c=b.attr("class").split(/\s+/);$.each(c,function(a){var d=c[a];"p3-transcript-container"!=d&&b.removeClass(d)}),b.addClass(a),setTimeout(function(){parent.resolve_transcript_height()},10),setTimeout(function(){parent.resolve_transcript_height()},50),setTimeout(function(){parent.resolve_transcript_height()},100),setTimeout(function(){parent.resolve_transcript_height()},250),setTimeout(function(){parent.resolve_transcript_height()},500),setTimeout(function(){parent.resolve_transcript_height()},1e3)}parent.settings.skin=a},this.resolve_transcript_height=function(){var a=$(this.container).find(".p3-transcript-container").outerHeight();a-=$(this.container).find(".p3-transcript-mediabar").outerHeight(),a-=$(this.container).find(".p3-transcript-controller").outerHeight(),a-=$(this.container).find(".p3-transcript-bottombar").outerHeight(),a-=2,$(this.transcript_container).css("height",a+"px")},this.transcript_request=function(){return parent.instance.settings.platform_integration&&this.settings.transcript_url_convention&&(this.settings.transcript_url=this.settings.transcript_url_convention.replace("{file_id}",this.settings.file_id)),this.settings.transcript_url?this.load_remote_transcript():this.load_static_transcript()},this.load_static_transcript=function(){P3.Util.load_remote_script(this.transcript_static_url())},this.load_scan_view=function(){P3.Util.load_remote_script(this.keywords_url())},this.timing_info=function(){for(var a=["transcript_offset","transcript_start","transcript_end"],b=[],c=0;c<a.length;c++)parent.settings[a[c]]&&/^\-*\d+$/.test(parent.settings[a[c]])&&b.push("&"+a[c].replace("transcript_","")+"="+parent.settings[a[c]]);return b.join("")},this.transcript_static_url=function(){for(var a={callback:"P3.instances["+parent.instance.instance_index+"].transcript.parse_transcript_data"},b=["transcript_offset","transcript_start","transcript_end"],c=0;c<b.length;c++)parent.settings[b[c]]&&/^\-*\d+$/.test(parent.settings[b[c]])&&(a[b[c].replace("transcript_","")]=parent.settings[b[c]]);return this.api_request("files/{id}/transcript","tpm",a)},this.load_remote_transcript=function(url){url=url||this.settings.transcript_url,parent.settings.cross_domain_loader?(parent.settings.cross_domain_dynamic_callback&&(url+=/\?/.test(url)?"&":"?",url+="callback=P3.instances["+parent.instance.instance_index+"].transcript.parse_transcript_data"),P3.Util.load_remote_script(url)):$.getJSON(url,function(obj){parent.parse_transcript_data(eval(obj))})},this.api_request=function(a,b,c){var d=P3.Settings.static_host;a&&(d+="/"+a.replace("{id}",parent.settings.file_id)),d+="."+(b||"js"),arr=[],c.apikey=parent.settings.api_key,c.usevideoid=parent.instance.settings.platform_integration?1:0;for(i in c)arr.push(i+"="+encodeURIComponent(c[i]));return d+="?"+arr.join("&")},this.download_url=function(){return this.api_request("files/{id}/transcript","txt",{dl:1})},this.keywords_url=function(){return this.api_request("files/{id}/keywords","js",{callback:"P3.instances["+parent.instance.instance_index+"].transcript.parse_scan_view_data"})},this.parse_transcript_data=function(a){try{if(a.errors||a.is_error)return parent.transcript_load_error(a);$(this.transcript_container).html(a.transcript),parent.settings.first_word=!1,this.file=a.file,this.transcript_cache={};var b=$(this.transcript_container).find("p");$.each(b,function(a){var c=$(b[a]).find("span:first"),d=parseInt($(c).attr("m"),10);parent.transcript_cache[d]=[],$.each($(b[a]).find("span"),function(){var a=parseInt($(this).attr("m"),10);parent.transcript_cache[d].push(a),$(this).attr("id",parent.paragraph_word_cache_key(d,a))})}),parent.settings.hide_onerror&&$(parent.container).show(),parent.clear_searched_transcript(),parent.clear_scan_view(),parent.instance.event.trigger("Transcript.Ready")}catch(c){parent.transcript_load_error(!1)}},this.transcript_load_error=function(a){parent.settings.hide_onerror&&$(parent.container).hide(),$(parent.transcript_container).html("<p>There was an error loading the transcript.</p>"),a&&(a.errors||a.is_error)&&$(parent.transcript_container).append("<p>The requested transcript was not found.</p>"),parent.instance.event.trigger("Transcript.LoadError")},this.parse_scan_view_data=function(obj){var keyvals={},re_arr=[],space_repl="(\\<[^\\>]*?\\>)*\\s*(\\<[^\\>]*?\\>)*\\s*",dostem="undefined"!=typeof Snowball;$.each(obj,function(a){var b=obj[a][0].replace(/^\s+|\s+$/,"");if(restr=b.replace(/\s+/g,space_repl),dostem){parent.stemmer=parent.stemmer||new Snowball("English");var c=b.split(/\s+/),d=[];for(j=0;j<c.length;j++){parent.stemmer.setCurrent(c[j]),parent.stemmer.stem();var e=parent.stemmer.getCurrent();d.push(e)}sstr=d.join(space_repl),keyvals[d.join(" ")]=obj[a][1],sstr!=restr&&(restr+="|"+sstr)}/\s/.test(b)?re_arr.unshift(restr):re_arr.push(restr),keyvals[b.toLowerCase()]=obj[a][1]});var bigre=eval('/<span[^>]+m="([^"]+?)"[^>]*>('+re_arr.join("|")+")[\b.!?)\"']*</gi"),matches={},tre=/\<[^\>]*\>/g,key=parent.cache_id;$(parent.transcript_container).find("p").each(function(){matches={};var a=$(this).html(),b=$(this).find("span:first").attr("m");a.replace(bigre,function(a,c,d){var e=d.replace(tre," ").replace(/\s+/g," ");matches[key+"_"+b+"_"+c]={s:e,v:keyvals[e.toLowerCase()]}});for(m in matches)for(var c=$(this).find("#"+m),d=matches[m].s.split(/\s+/).length,e=0;d>e;e++)c.css("font-size",matches[m].v+"%"),c.addClass("p3-keyword"),c=c.next()}),$(parent.container).find(".scan-view span").html("Normal View")},this.clear_scan_view=function(){if(!parent.settings.scan_view)return!1;var a=$(parent.transcript_container).find(".p3-keyword");a.css("font-size",""),a.removeClass("p3-keyword"),$(parent.container).find(".scan-view span").html("Scan View")},this.paragraph_word_cache_key=function(a,b){return parent.cache_id+"_"+a+"_"+b},this.last_word=function(){var a=this.transcript_cache.length-1,b=this.transcript_cache[a].length-1;return this.paragraph_word_cache_key(a,b)},this.track=function(a){if(!parent.transcript_cache)return!1;$(this.container).find(".p3-timeline-progress").css({width:Math.min(100,100*(a/parent.file.duration))+"%"});var b=!1,c=!1;if($.each(parent.transcript_cache,function(b){return c||(c=b),b>a?!1:void(c=b)}),$.each(parent.transcript_cache[c],function(d){if(parent.transcript_cache[c][d]>=a){var e=parent.transcript_cache[c][d];return b=$("#"+parent.paragraph_word_cache_key(c,e)),parent.settings.track_alt&&b.prev().length>0&&(b=b.prev()),!1}}),!b){var d=parent.transcript_cache[c].slice(-1);b=$("#"+parent.paragraph_word_cache_key(c,d))}return parent.track_to_word(b,c),this.settings.locked!==!0?!1:this.settings.global_unlock===!0?!1:void parent.scroll_to_word(parent.current_word)},this.track_to_word=function(a,b){if(parent.current_word==a)return!1;if(parent.settings.progressive_tracking){if(parent.current_paragraph!=b){$(parent.container).find(".tracked_paragraph").removeClass("tracked_paragraph"),$(parent.container).find(".current_paragraph").removeClass("current_paragraph");var c=$(a).parents("p:first").prevAll();$(c).addClass("tracked_paragraph"),$(a).parents("p:first").addClass("current_paragraph");var d=$(a).parents("p:first").nextAll();$(d).removeClass("tracked_paragraph")}$(a).nextAll().removeClass("tracked_word"),$(a).prevAll().addClass("tracked_word"),$(a).addClass("tracked_word")}else $(parent.current_word).removeClass("current_word"),$(a).addClass("current_word");parent.settings.track_highlighted_words&&parent.instance.event.trigger("Transcript.HighlightedWord",{m:$(a).attr("m"),word:$(a).html()}),parent.current_paragraph=b,parent.current_word=a},this.scroll_to_word=function(a){if(!parent.settings.locked)return!1;parent.settings.first_word=parent.settings.first_word||this.transcript_container.find("span[m]:first");var b=this.transcript_container.scrollTop(),c=parseInt($(a).offset().top-$(parent.settings.first_word).offset().top,10),d=parseInt(b,10);if(parent.settings.light_scroll){var e=$(parent.transcript_container).height();(c-b>.75*e||0>c-b)&&this.transcript_container.scrollTop(c)}else c!=d&&this.transcript_container.scrollTop(c)},this.clear_searched_transcript=function(){$(parent.container).find(".p3-transcript-search-reset").hide(),$(parent.transcript_container).find(".search_hit").removeClass("search_hit"),$(parent.container).find(".pointer").remove(),$(".p3-tooltip").remove(),$(parent.container).find(".p3-bottombar-timeline-container").hide(),$(parent.container).find(".p3-transcript-bottombar-logo").show()},this.search_transcript=function(searchterm,callback){parent.clear_searched_transcript(),callback=callback||"topbar_search";var sanitized_arr=searchterm.replace(/^\s+|\s+$/,"").split(/\s+/);if(parent.saved_search_term=sanitized_arr.join("|"),""==sanitized_arr.join(""))return!1;parent.settings.search_transcript_stemming&&"undefined"!=typeof Snowball&&(parent.stemmer=parent.stemmer||new Snowball("English"),$.each(sanitized_arr,function(a,b){parent.stemmer.setCurrent(b),parent.stemmer.stem();var c=parent.stemmer.getCurrent();P3.Util.in_array(c,sanitized_arr)||sanitized_arr.push(c)})),$(parent.container).find(".p3-transcript-search-reset").show();var sanitized=sanitized_arr.join("|"),re=eval("/("+sanitized+")/i"),matches=[];$(parent.transcript_container).find("span").each(function(){re.test($(this).html())&&($(this).addClass("search_hit"),matches.push(parseInt($(this).attr("m"),10)))}),callback&&parent[callback](matches),parent.instance.event.trigger("Transcript.Search",{searchterm:searchterm})},this.topbar_search=function(a){$(parent.container).find(".p3-timeline").css("position","relative");$(parent.container).find(".p3-timeline").outerHeight();$.each(a,function(b){var c=a[b],d=parseInt(100*(c/parent.file.duration))+"%",e=$("<span></span>");$(e).attr("m",c),$(e).addClass("pointer"),$(e).html("&nbsp;"),$(e).css({position:"absolute",top:0,bottom:0,width:"2px",zIndex:2e3,left:d}),$(parent.container).find(".p3-timeline").append(e)})},this.bottombar_search=function(a){var b=a.length>=100?"99+":a.length;$(parent.container).find(".p3-bottombar-timeline-hits").html(b+" results");var c=$(parent.container).find(".p3-bottombar-timeline-container");$(c).show(),$(parent.container).find(".p3-transcript-bottombar-logo").hide();var d=$(parent.container).find(".p3-bottombar-timeline");$(d).show(),$(c).css("width","120px"),$(d).css("width","120px"),$.each(a,function(b){var c=a[b],e=parseInt(100*(c/parent.file.duration))+"%",f=$("<span></span>");$(f).attr("m",c),$(f).addClass("pointer"),$(f).html("&nbsp;"),$(f).css({position:"absolute",top:4,bottom:4,width:"2px",zIndex:2e3,left:e}),$(d).append(f)}),a.length<=50?$(c).animate({width:"245px"},200):$(c).css({width:"245px"})},this.print_transcript=function(){var a=$(parent.transcript_container).html();a=a.replace(/\<span[^\>]*?\>/,""),P3.Util.print(a,!0)},this.handle_selected_text=function(){var a=P3.Util.selected_html();if(!a)return!1;var b=$("<p></p>");b.append(a);var c=b.find("span:first"),d=b.find("span:last"),e=parseInt($(c).attr("m"),10),f=parseInt($(d).attr("m"),10),g=/^\s+|\s+$/,h=[];if($(b).find("span").each(function(){var a=$(this).html().replace(g,"");h.push(a)}),h=h.join(" "),shortened_text=h.length>100?(h.slice(0,40)+" [...] "+h.slice(-40)).replace(/\s+/," "):h,!e)return!1;if(!f)return!1;if(e==f)return!1;if(!h)return!1;var i={start_ms:e,end_ms:f,duration:f-e,raw_text:h,shortened_text:shortened_text};parent.instance.event.trigger("Transcript.Selection",i)},this.get_shortened_link=function(a,b){url=a.url||location.href,context=a.shortened_text||"",P3.Util.shorten_url(url,context,function(a){$(b.target).html(a),$(b.target).css("text-transform","none"),$(b.target).die("click"),$(b.target).click(function(){window.open(a)})})},this.start_clip_share=function(){if($(parent.container).find(".p3-social-sharing").length>0)return $(parent.container).find(".p3-social-sharing").remove(),!1;var a=parent.settings.current_clip_selection,b=new EJS({text:parent.social,type:"["}).render(a);$(parent.container).find(".p3-transcript-container").append(b);var c=$(parent.container).find(".p3-social-sharing"),d=$(parent.container).find(".clip-active"),e=$(d).offset().top+$(d).outerHeight(),f=$(d).offset().left-.5*$(c).outerWidth();$(c).css({top:e,left:f})},this.tweet_clip=function(a){url=a.url||location.href,context=a.shortened_text||"",P3.Util.shorten_url(url,context,function(a,b){b=b?' "'+b+'"':"";var c="Video Bookmark "+a+b+" #3playmedia",d="http://twitter.com/?status="+encodeURIComponent(c);window.open(d)})},this.facebook_clip=function(a){url=a.url||location.href,context=a.shortened_text||"",context=context?' "'+context+'"':"";var b="http://www.facebook.com/share.php?u="+encodeURIComponent(location.href);b+="&t="+encodeURIComponent("Video Bookmark"),window.open(b)},$(instance).bind("Transcript.Selection",function(a,b){if(parent.settings.can_clip){$(parent.container).find(".clip-inactive").removeClass("clip-inactive").addClass("clip-active");var c=location.href.replace(/\#.+?$/,"");c+="#p3s:"+b.start_ms+"&p3e:"+b.end_ms,c+=P3.instances.length>1?"&p3i:"+parent.instance.instance_index:"",location.href=c,b.url=c,parent.settings.current_clip_selection=b}}),$(instance).bind("Player.Progress",function(a,b){return parent.instance.player&&parent.instance.player.interface&&parent.instance.player.interface.play?b.video_id&&b.video_id!=parent.settings.file_id?(parent.settings.file_id=b.video_id,parent.instance.settings.file_id=b.video_id,parent.transcript_request(),!1):void parent.track(b.m):!1}),$(instance).bind("Player.VideoLoad",function(a,b){parent.instance.settings.file_id=b.video_id,parent.settings.file_id=b.video_id,parent.transcript_request()}),$(instance).bind("Transcript.Ready",function(){if(P3.Util.params("p3ts")&&!parent.settings.onload_transcript_search_handled){var a=unescape(P3.Util.params("p3ts"));$(parent.container).find(".p3-transcript-search").val(a),parent.search_transcript(a,"topbar_search"),parent.settings.onload_transcript_search_handled=!1}}),parent.instance.event.trigger("Transcript.TemplateRendered"),this.social='<div start_ms="[%=start_ms%]" end_ms="[%=end_ms%]" url="[%=url%]" class="p3-social-sharing">    <table cellSpacing=0>      <thead>        <tr>          <th>Share @ [%=P3.Util.ms_to_stamp(start_ms)%]-[%=P3.Util.ms_to_stamp(end_ms)%]</th>          <th style="text-align:right;">            <a class="p3-close-social-sharing" href=javascript:void(0);>x</a>          </th>        </tr>      </thead>      <tbody>        <tr>          <td colspan="2" class="p3-clip-text">"[%= shortened_text %]"</td>        </tr>        <tr>          <td colspan=2><a class="p3-tweet-clip" href="javascript:void(0);">Share on Twitter</a></td>        </tr>        <tr>          <td colspan=2><a class="p3-facebook-clip" href="javascript:void(0);">Share on Facebook</a></td>        </tr>        <tr>          <td colspan=2><a class="p3-get-shortened-link" href="javascript:void(0);">Get Shortened Link</a></td>        </tr>      </tbody>    </table>  </div>',this.templates={},this.templates.transcript_only='<div class="p3-container p3-transcript-container">    <div class="p3-transcript-main"><p>Loading Transcript...</p></div>  </div>',this.templates.bottom_search='<div class="p3-container p3-transcript-container">    <div class="p3-transcript-main"><p>Loading Transcript...</p></div>    <div class="p3-transcript-bottombar">      <div class="p3-transcript-bottombar-logo">&nbsp;</div>      <div class="p3-transcript-bottombar-content">      <input type="text" placeholder="[%=search_placeholder%]" class="p3-transcript-bottom-search"/>      <button class="p3-transcript-bottom-search-submit"></button>      <div class="p3-bottombar-timeline-container">        <div class="p3-bottombar-timeline-hits">3 results</div>        <div class="p3-bottombar-timeline"></div>        <div class="p3-bottombar-reset-search">&nbsp;</div>    </div>  </div>',this.templates["default"]='<div class="p3-container p3-transcript-container">    <div class="p3-transcript-mediabar">      <div class="p3-timeline">        <div class="p3-timeline-progress">&nbsp;</div>      </div>    </div>    <div class="p3-transcript-controller">      <form class="p3-transcript-searchform" action="javascript:void(0); return false;">        <div class="p3-transcript-search-inputs">          [%= P3.Util.nice_searchbox({classname:"p3-transcript-search",placeholder:search_placeholder}) %]          <button class="p3-transcript-search-submit"></button>          <div class="p3-transcript-search-reset">&nbsp;</div>        </div>        <div class="p3-transcript-buttons">        [% if (can_clip) { %]        <a class="p3-transcript-button clip-inactive" href=javascript:void(0);><span>Clip</span></a>        [% } %]        [% if (can_print) { %]        <a class="p3-transcript-button print" href=javascript:void(0);><span>Print</span></a>        [% } if (can_download) { %]        <a class="p3-transcript-button download" href=javascript:void(0);><span>Download</span></a>        [% } %]        [% if ((!global_unlock) && locked != "never") { %]        <a class="p3-transcript-button locked" href=javascript:void(0);><span>Unlock</span></a>        [% } %]        </div>      </form>    </div>    <div class="p3-transcript-main"><p>Loading Transcript...</p></div>    <div class="p3-transcript-bottombar">      <div class="p3-transcript-bottombar-logo">&nbsp;</div>      <div class="p3-transcript-bottombar-content">      [% if (can_collapse) { %]      <a href="javascript:void(0);" class="p3-transcript-button collapse"><span>[%=collapse_label%]</span></a>      [% } %]      [% if (scan_view) { %]        <a href="javascript:void(0);" class="scan-view"><span>Scan View</span></a>      [% } %]      [% if (transcript_versions) { %]        <select class="p3-transcript-versions">          [% for (i in transcript_versions) { %]            <option value="[%= transcript_versions[i] %]">[%= i %]</option>          [% } %]        </select>      [% } %]      </div>    </div>  </div>',this.init()},P3.Captions=function(instance,options){var $=P3.JQuery,parent=this;this.instance=instance,this.initialized=!1,this.cached_duration=!1,this.minimized_fade_out_timer=!1,this.settings={api_key:!1,skin:!1,file_id:!1,srt_url:!1,srt_url_convention:!1,overlay:!1,overlay_draggable:!1,overlay_offset_x:!1,overlay_offset_y:!1,overlay_minimized_offset_x:!1,overlay_minimized_offset_y:!1,minimize_onload:!1,tracks:!1,cross_domain_loader:!0,cross_domain_dynamic_callback:!0,hide_onerror:!1,menubar:!0,menu_header:!1,searchbar:!0,toggler_enabled:!1,toggler_show_text:"<span>Show Closed Captions</span>",toggler_hide_text:"<span>Hide Closed Captions</span>",toggler_hide_onload:!1,captions_offset:!1,captions_start:!1,captions_end:!1,width:"280px",height:"40px",floater_position:"auto"},this.frames=!1,this.init=function(){return this.initialized?!0:($.each(options.captions,function(a){parent.settings[a]=options.captions[a]}),parent.settings.height="40px",parent.settings.file_id||(parent.settings.file_id=parent.instance.settings.file_id),parent.settings.api_key||(parent.settings.api_key=P3.Settings.api_key),this.render(),this.listen(),this.initialized=!0,void 0)},this.die=function(){$(this.container).remove()},this.duration=function(){return this.cached_duration?this.cached_duration:(this.cached_duration=parent.instance.player.interface.duration(),this.cached_duration)},this.container=!1,this.render=function(){($.browser.msie&&parseFloat($.browser.version)<8||P3.Util.is_ipad())&&(this.settings.overlay=!1,this.settings.minimize_onload=!1,this.settings.width=$(parent.instance.player.player).outerWidth(),this.settings.fallback_skin!==!1&&(this.settings.skin=this.settings.fallback_skin));var a=new EJS({text:parent.template,type:"["}).render(parent.settings),b=$(a);if(this.settings.overlay?($(document.body).append(b),parent.container=b,$(parent.instance.player.player).attr("wmode","opaque"),$(b).addClass("overlay"),this.settings.overlay_draggable&&$(b).draggable({handle:":not(.p3-captions-maximizer,.p3-captions-maximizer-arrow,.p3-captions-maximizer-cc)",drag:function(){parent.cache_overlay_position(),parent.remove_floater()}}),$(b).hide(),setTimeout(function(){$(b).show(),parent.position_overlay(),parent.settings.minimize_onload&&(parent.minimize(-1),parent.minimized_fade_out())},1)):(parent.settings.target?$("#"+parent.settings.target).html(b):$(parent.instance.player.player).after(b),parent.container=b,$(b).css({position:"static",display:"block",clear:"both"})),this.settings.width&&$(b).css("width",parseInt(this.settings.width,10)),$(b).attr("owidth",$(b).width()),this.apply_skin(),this.initialize_captions(),this.adjust_components(),this.settings.minimize_onload&&this.settings.overlay||(setTimeout(function(){parent.adjust_components()},10),setTimeout(function(){parent.adjust_components()},50),setTimeout(function(){parent.adjust_components()},100),setTimeout(function(){parent.adjust_components()},250),setTimeout(function(){parent.adjust_components()},500)),this.settings.toggler_enabled){var a=new EJS({text:parent.toggler_template,type:"["}).render(parent.settings),c=$("<div class='p3-captions-toggler-container'></div>");$(c).html(a),this.settings.toggler_target?$(this.settings.toggler_target).html(c):$(b).after(c),$(c).find("a").attr("instance_index",parent.instance.instance_index)}this.settings.toggler_hide_onload&&$(b).hide(),parent.instance.event.trigger("Captions.TemplateRendered")},this.render_floater=function(a){this.remove_floater();var b=new EJS({text:a,type:"["}).render(parent.settings),c=$("<div class='p3-captions-floater'>"+b+"</div>");$(document.body).append(c),$(c).addClass(parent.settings.skin);var d=Math.max(0,$(parent.container).offset().top+.5*($(parent.container).outerHeight()-$(c).outerHeight())),e=$(parent.container).offset().left+$(parent.container).outerWidth();$(c).css({top:d,left:e});var f=P3.Util.window_dimensions().width;if(f<$(c).offset().left+$(c).outerWidth()||"bottom"==parent.settings.floater_position){var d=Math.max(0,$(parent.container).offset().top+$(parent.container).outerHeight()),e=$(parent.container).offset().left+$(parent.container).outerWidth()-$(c).outerWidth();$(c).addClass("no-pointer"),$(c).css({top:d,left:e})}if("top"==parent.settings.floater_position){var d=Math.max(0,$(parent.container).offset().top-$(c).outerHeight()),e=$(parent.container).offset().left+$(parent.container).outerWidth()-$(c).outerWidth();$(c).addClass("no-pointer"),$(c).css({top:d,left:e})}},this.remove_floater=function(){$(".p3-captions-widget").find(".active").removeClass("active"),$(".p3-captions-floater").remove()},this.hide_components=function(){return!1},this.listen=function(){$(document).click(function(a){var b=a.target;0==$(b).parents(".p3-captions-floater").length&&!$(b).hasClass("p3-captions-floater")&&0==$(b).parents(".p3-container").length&&parent.remove_floater()}),$(parent.container).find(".p3-captions-minimizer").click(function(){parent.minimize()}),$(parent.container).find(".p3-captions-maximizer").click(function(){parent.maximize()}),$(".p3-captions-toggler-container a[instance_index="+parent.instance.instance_index+"]").click(function(){var a=parseInt($(this).attr("instance_index"),10);return"hidden"==$(this).attr("state")?($(this).attr("state","visible"),$(this).html(parent.settings.toggler_hide_text),P3.get(a).captions.container.show(),P3.get(a).captions.adjust_components()):($(this).attr("state","hidden"),$(this).html(parent.settings.toggler_show_text),P3.get(a).captions.container.hide()),!1}),$(this.container).find(".p3-captions-search").click(function(){return $(this).hasClass("active")?parent.remove_floater():($(".p3-captions-widget").find(".active").removeClass("active"),parent.render_floater(parent.search_box),$(this).addClass("active"),P3.Util.is_ios()||$(".p3-captions-floater").find(".p3-captions-searchterm").focus(),$(".p3-captions-floater").find(".p3-captions-searchterm").unbind("keyup"),$(".p3-captions-floater").find(".p3-captions-searchterm").keyup(function(){clearTimeout(parent.settings.search_timeout);var a=this,b=$.browser.msie?500:250;parent.settings.search_timeout=setTimeout(function(){parent.search_captions($(a).val()),$(".p3-captions-searchresult").click(function(){"PLAYING"!=parent.instance.player.interface.play_state()&&parent.instance.player.interface.play(),parent.instance.player.interface.seek(parseInt($(this).attr("ms"),10))}),$(".p3-captions-searchresult:first").addClass("first"),$(".p3-captions-searchresult:last").addClass("last")},b)})),!1}),$(this.container).find(".p3-captions-menu").click(function(){return $(this).hasClass("active")?parent.remove_floater():($(".p3-captions-widget").find(".active").removeClass("active"),parent.render_floater(parent.menu_box),$(this).addClass("active"),$(".p3-captions-floater").find(".p3-caption-track").each(function(){return parent.settings.current_track&&$(this).html()==parent.settings.current_track?($(this).addClass("selected"),!1):void 0}),$(".p3-captions-floater").find(".p3-caption-track").click(function(){$(this).siblings().removeClass("selected"),$(this).addClass("selected"),parent.load_track($(this).html())}),$(".p3-captions-floater").find("li:first").addClass("first"),$(".p3-captions-floater").find("li:last").addClass("last")),!1}),parent.settings.overlay&&($(parent.instance.player.player).mouseover(function(){$(parent.container).hasClass("minimized")&&parent.minimized_fade_in()}),$(parent.instance.player.player).parent().mouseover(function(){$(parent.container).hasClass("minimized")&&parent.minimized_fade_in()}),$(parent.instance.player.player).mouseout(function(){$(parent.container).hasClass("minimized")&&parent.minimized_fade_out()}),$(parent.instance.player.player).parent().mouseout(function(){$(parent.container).hasClass("minimized")&&parent.minimized_fade_out()}))},this.apply_skin=function(a){if(a=a||parent.settings.skin,!a)return!1;if(a=/p3\-captions\-skin/.test(a)?a:"p3-captions-skin-"+a){var b=$(this.container),c=b.attr("class").split(/\s+/);
$.each(c,function(a){var d=c[a];/p3-captions-skin/i.test(d)&&b.removeClass(d)}),b.addClass(a)}},this.adjust_components=function(){$(this.container).css({width:parseInt(parent.settings.width,10)+"px",height:parseInt(parent.settings.height,10)+"px"}),$(this.container).find(".p3-captions-components").css({width:parseInt(parent.settings.width,10)+"px",height:parseInt(parent.settings.height,10)+"px"}),$(this.container).find(".p3-captions-components").children().css({height:parseInt(parent.settings.height,10)+"px"});var a=$(this.container).find(".p3-captions-frame"),b=a.children(),c=$(this.container).width();$(a).siblings().each(function(){c-=$(this).outerWidth(),c-=parseFloat($(this).css("margin-left")),c-=parseFloat($(this).css("margin-right"))}),P3.Util.is_ie()&&(c-=2),$(a).css("width",c+"px"),$(b).css("width",c+"px");var d=Math.max(0,Math.min(6,($(a).height()-$(b).height())/2));$(b).css("padding-top",d+"px"),$(b).css("padding-bottom",d+"px"),parent.position_overlay()},this.initialize_captions=function(){parent.settings.tracks?$.each(parent.settings.tracks,function(a){return parent.load_track(a),!1}):this.load_captions()},this.load_captions=function(){return parent.instance.settings.platform_integration&&this.settings.srt_url_convention&&(this.settings.srt_url=this.settings.srt_url_convention.replace("{file_id}",this.settings.file_id)),this.settings.srt_url?this.load_external_srt_url():this.load_static_srt_captions()},this.load_external_srt_url=function(a){a=a||this.settings.srt_url,parent.settings.cross_domain_loader?(parent.settings.cross_domain_dynamic_callback&&(a+=/\?/.test(a)?"&":"?",a+="callback=P3.instances["+parent.instance.instance_index+"].captions.parse_captions_data"),P3.Util.load_remote_script(a)):$.get(a,function(a){parent.frames=parent.srt_lines_to_frames(a.split(/[\r\n]+/))})},this.load_static_srt_captions=function(){var a=document.createElement("script");a.src=this.static_srt_url(),a.type="text/javascript",$(parent.container).get(0).appendChild(a)},this.timing_info=function(){for(var a=["captions_offset","captions_start","captions_end"],b=[],c=0;c<a.length;c++)parent.settings[a[c]]&&/^\-*\d+$/.test(parent.settings[a[c]])&&b.push("&"+a[c].replace("captions_","")+"="+parent.settings[a[c]]);return b.join("")},this.static_srt_url=function(){var a=(/https/.test(location.protocol)?P3.Settings.api_host:P3.Settings.static_host)+"/files/";return a+=parent.instance.settings.file_id,a+="/captions.srt?apikey="+this.settings.api_key,a+=parent.timing_info(),a+=parent.instance.settings.platform_integration?"&usevideoid=1":"",a+="&callback=P3.instances["+parent.instance.instance_index+"].captions.parse_captions_data"},this.load_track=function(a){if(!parent.settings.tracks[a])return!1;var b=parent.settings.tracks[a];parent.settings.current_track=a,parent.settings.srt_url=b,parent.load_external_srt_url()},this.parse_captions_data=function(a){try{var b=a.output;if(parent.frames=parent.srt_lines_to_frames(b.split(/[\r\n]/)),parent.instance.player.interface&&parent.instance.player.interface.play_state&&"PLAYING"!=parent.instance.player.interface.play_state()){var c=parent.instance.player.interface.position()||0;parent.track(c)}}catch(d){return parent.captions_load_error()}parent.settings.hide_onerror&&$(parent.container).show(),parent.instance.event.trigger("Captions.Ready")},this.captions_load_error=function(){parent.settings.hide_onerror&&$(parent.container).hide(),parent.render_line("ERROR: Could not<br/>load captions."),parent.instance.event.trigger("Captions.LoadError")},this.srt_lines_to_frames=function(a){var b=[],c={},d=0,e=/\s*\-\-\>\s*/,f=/^\d+$/;return $.each(a,function(g){var h=a[g].replace(/^\s+|\s+$/,"");switch(!0){case e.test(h):c.lines&&(b.push(c),c={});var i=h.split(e);c.start_ms=P3.Util.stamp_to_ms(i[0]),c.end_ms=P3.Util.stamp_to_ms(i[1]),c.lines=[];break;case f.test(h)&&parseInt(h)==d+1:d+=1;break;case""==h:break;default:c.lines&&c.lines.push(h)}}),c&&c.start_ms&&c.end_ms&&b.push(c),b},this.minimize=function(a){parent.remove_floater(),a=a||150;var b=parent.minimized_position();parent.cache_overlay_position();var c={width:"34px",height:"20px",top:b.top,left:b.left};$(parent.container).addClass("minimized"),$(parent.container).children().hide(),a>0?$(parent.container).animate(c,a,function(){$(parent.container).find(".p3-captions-maximizer").show(),$(parent.container).find(".p3-captions-maximizer").children().show()}):($(parent.container).css(c),$(parent.container).find(".p3-captions-maximizer").show(),$(parent.container).find(".p3-captions-maximizer").children().show())},this.maximize=function(a){a=a||150;var b=parent.overlay_position();clearTimeout(parent.minimized_fade_out_timer),$(parent.container).removeClass("minimized"),$(parent.container).fadeIn(1),$(parent.container).find(".p3-captions-maximizer").hide(),$(parent.container).animate({width:parseInt(parent.settings.width,10)+"px",height:parseInt(parent.settings.height,10)+"px",top:b.top,left:b.left},a,function(){$(parent.container).children().show(),$(parent.container).find(".p3-captions-maximizer").hide(),parent.adjust_components(),setTimeout(function(){parent.adjust_components()},10)})},this.minimized_fade_out=function(){parent.minimized_fade_out_timer=setTimeout(function(){return parent.container.hasClass("minimized")?void $(parent.container).fadeOut(500):!1},3e3)},this.minimized_fade_in=function(a){a=a||500,clearTimeout(parent.minimized_fade_out_timer),$(parent.container).fadeIn(a)},this.cache_overlay_position=function(){var a=$(parent.container).offset();$(parent.container).attr("cache_top",a.top),$(parent.container).attr("cache_left",a.left)},this.position_overlay=function(){if(!parent.settings.overlay)return!1;var a=parent.overlay_position();$(parent.container).css({top:a.top,left:a.left})},this.overlay_position=function(){if("undefined"!=typeof $(parent.container).attr("cache_top")&&"undefined"!=typeof $(parent.container).attr("cache_left"))return{top:$(parent.container).attr("cache_top"),left:$(parent.container).attr("cache_left")};var a=parent.instance.player.player,b=parent.container,c=$(a).offset(),d=$(a).outerWidth(),e=$(a).outerHeight(),f=$(b).outerWidth(),g=$(b).outerHeight(),h=c.top+e-g;h+="number"==typeof parent.settings.overlay_offset_y?parent.settings.overlay_offset_y:0;var i=c.left;return i+="number"==typeof parent.settings.overlay_offset_x?parent.settings.overlay_offset_x:(d-f)/2,{top:h,left:i}},this.minimized_position=function(){var a=parent.instance.player.player,b=$(a).offset(),c=$(a).outerWidth(),d=$(a).outerHeight(),e=b.top+d-34;e+="number"==typeof parent.settings.overlay_minimized_offset_y?parent.settings.overlay_minimized_offset_y:0;var f=b.left+c-40;return f+="number"==typeof parent.settings.overlay_minimized_offset_x?parent.settings.overlay_minimized_offset_x:0,{top:e,left:f}},this.render_line=function(a){var b=/\<br\/*\>/i;return a.length>32&&!b.test(a)&&(a=parent.waterfall(a)),a=a.replace(/^\<br\/*>/,""),a=b.test(a)?a:a+"<br/>&nbsp;",a==$(parent.container).find(".p3-captions-frame-lines").html()?!1:void $(parent.container).find(".p3-captions-frame-lines").html(a)},this.waterfall=function(a){a=a.replace(/^\s+|\s+$/,"");var b=" ";/\s+/.test(a)?arr=a.split(/\s+/):(arr=a.split(""),b="");var c=arr,d=[],e=Math.abs(c.join(" ").length-d.join(" ").length);for(d.push(c.pop());Math.abs(c.join(" ").length-d.join(" ").length)<e;)e=Math.abs(c.join(" ").length-d.join(" ").length),d.unshift(c.pop());return c.join(b)+"<br/>"+d.join(b)},this.track=function(a){if(!parent.frames)return!1;var b=!1,c=!1;$.each(parent.frames,function(d){return a>=parent.frames[d].start_ms&&a<=parent.frames[d].end_ms?(c=parent.frames[d],b=!0,!1):void 0}),b||(c=parent.frames[parent.frames.length-1]);var d=c.lines.join("<br/>"),e={text:d,frame_ms:c.start_ms,current_ms:a};parent.instance.event.trigger("Captions.FrameRendered",e),parent.render_line(d)},this.search_captions=function(str){$(".p3-captions-searchresults").html("<div class='p3-captions-searchresult-info'>No matches found</div>");var scrubbed=str.replace(/^\s+|\s+$/,"").replace(/\s+/,"|");if(!scrubbed)return!1;$(".p3-captions-searchresults").html("");var re=eval("/("+scrubbed.replace(/^\s+|\s+$/).replace(/\s+/,"|")+")/i"),re_g=eval("/("+scrubbed.replace(/^\s+|\s+$/).replace(/\s+/,"|")+")/ig"),matches=0,last_ms=parent.frames[parent.frames.length-1].start_ms;if($.each(parent.frames,function(a){var b=parent.frames[a].lines.join(" ");if(re.test(b)){matches++,pct=100*(parent.frames[a].start_ms/last_ms)+"%",b=b.replace(re_g,"<b>$1</b>"),obj={text:b,stamp:P3.Util.ms_to_stamp(parent.frames[a].start_ms),ms:parent.frames[a].start_ms,pct:pct};var c=new EJS({text:parent.search_result,type:"["}).render(obj);$(".p3-captions-searchresults").append(c)}}),0==matches){var result="<div class='p3-captions-searchresult-info'>No matches found</div>";$(".p3-captions-searchresults").append(result)}$(".p3-captions-searchresults").find(".p3-captions-searchresult:first").addClass("first"),$(".p3-captions-searchresults").find(".p3-captions-searchresult:last").addClass("last")},$(instance).bind("Player.Ready",function(){parent.init()}),$(instance).bind("Player.Progress",function(a,b){return b.video_id&&b.video_id!=parent.settings.file_id?(parent.instance.settings.file_id=b.video_id,parent.settings.file_id=b.video_id,parent.load_captions(),!1):void parent.track(b.m)}),$(instance).bind("Player.VideoLoad",function(a,b){parent.instance.settings.file_id=b.video_id,parent.settings.file_id=b.video_id,parent.load_captions()}),this.template='<div class="p3-container p3-captions-widget">    [% if (overlay) { %]      <div class="p3-captions-maximizer">        <div class="p3-captions-maximizer-arrow"></div>        <div class="p3-captions-maximizer-cc">cc</div>      </div>    [% } %]    <div class="p3-captions-components">      [% if (overlay) { %]        <div class="p3-captions-minimizer"><span>x</span></div>      [% } %]      <div class="p3-captions-frame">        <div class="p3-captions-frame-lines">          &nbsp;<br/>          &nbsp;        </div>      </div>      [% if (searchbar == true) { %]        <div class="p3-captions-search"><span></span></div>      [% } %]      [% if (menubar && tracks && typeof tracks == "object") { %]        <div class="p3-captions-menu"><span></span></div>      [% } %]    </div>  </div>',this.toggler_template='<a href=javascript:void(0); state="[%=toggler_hide_onload ? "hidden" : "visible" %]" class="p3-captions-toggler">[%=toggler_hide_onload ? toggler_show_text : toggler_hide_text %]</a>',this.cc_button='<div class="p3-captions-cc-button-container">    <div class="p3-captions-maximizer"></div>    <div class="p3-captions-cc-button">CC</div>  </div>',this.search_box='<div class="p3-captions-search-container">    <div class="p3-captions-searchbox">      [%= P3.Util.nice_searchbox({classname:"p3-captions-searchterm",placeholder:"Search Video"}) %]    </div>    <div class="p3-captions-searchresults">      <div class="p3-captions-searchresult-info">Type to search this video</div>    </div>  </div>',this.search_result='<div class="p3-captions-searchresult" ms="[%= ms %]">    <div class="p3-captions-searchresult-header">      <div class="p3-captions-searchresult-stamp">        [%= stamp %]      </div>      <div class="p3-captions-searchresult-timeline"><div style="width:[%=pct%];" class="p3-captions-searchresult-time-in"></div></div>    </div>    <div class="p3-captions-searchresult-content">      [%= text %]    </div>  </div>',this.menu_box='<div class="p3-captions-menubox">    [%= menu_header ? "<h3>" + menu_header + "</h3>" : "" %]    <ul>      [% for (i in tracks) { %]        <li class="p3-caption-track" url="[%=tracks[i]%]">[%=i%]</li>      [% } %]    </ul>  </div>'},P3.Playlist=function(instance,options){var $=P3.JQuery,parent=this;this.instance=instance,this.searchterm="",this.settings={target:!1,width:"400px",playlist_height:"400px",skin:"",suggested_search_terms:[],onload_function:"all_files",search_box_placeholder:"Search by phrase, name, keyword...",list_sort_by:"id:desc",search_sort_by:"id:desc",show_segments:!0,show_thumbnails:!0,show_all_results:!1,per_page:10,project_id:!1,linked_account_id:!1,folder_id:!1,base_url:location.protocol+"//static.3playmedia.com/",api_key:!1},this.container=$("#"+options.playlist.target),this.init=function(){if($.each(options.playlist,function(a){parent.settings[a]=options.playlist[a]}),!parent.settings.target)return!1;if(parent.settings.api_key||(parent.settings.api_key=P3.Settings.api_key),parent.settings.per_page=Math.min(parent.settings.per_page,15),parent.settings.width=parseInt(parent.settings.width.toString().replace("px",""),10),parent.settings.width=Math.min(parent.settings.width,800),parent.settings.playlist_height=parseInt(parent.settings.playlist_height.toString().replace("px",""),10),parent.settings.playlist_height=Math.max(parent.settings.playlist_height,150),this.render(),this.apply_skin(),this.listen(),parent.settings.onload_function)try{eval("parent."+parent.settings.onload_function+"()")}catch(e){}},this.render=function(){var a=new EJS({text:parent.template,type:"["}).render(parent.settings);$(this.container).html(a),this.collection_container=$(this.container).find(".p3-playlist-container"),$(this.collection_container).css({width:parent.settings.width}),$(this.collection_container).find(".p3-playlist-results").css({height:parent.settings.playlist_height}),$(this.container).find("input[type=text]").each(function(){var a=$(this).val();$(this).attr("oval",a)}),parent.instance.event.trigger("Playlist.TemplateRendered")},this.apply_skin=function(a){if(a=a||parent.settings.skin){var b=$(this.collection_container),c=b.attr("class").split(/\s+/);$.each(c,function(a){var d=c[a];"p3-playlist-container"!=d&&b.removeClass(d)}),b.addClass(a),this.settings.skin=a}parseInt(parent.settings.width.toString().replace("px",""),10)<=250&&$(this.collection_container).addClass("p3-playlist-narrow")},this.listen=function(){$(this.container).find(".p3-playlist-suggested-results").live("mouseover",function(a){msg=$(this).hasClass("drop_up")?"Show Keywords":"Hide Keywords",P3.Util.tooltip(a,msg,parent.settings.skin)}),$(this.container).find(".p3-playlist-ul li a").live("click",function(){var a=$(this).parents("li:first");return $(a).attr("video_id")==parent.instance.player.interface.video_id()?!1:($(parent.container).find(".p3-playlist-currently-loading").removeClass("p3-playlist-currently-loading"),$(a).addClass("p3-playlist-currently-loading"),parent.instance.player.load_video({video_id:$(a).attr("video_id"),m:0}),void 0)}),$(this.container).find(".p3-playlist-suggested-search-terms a").live("click",function(){var a=$(this).html();$(parent.container).find(".p3-playlist-searchterm").val(a),parent.search(a)}),$(this.container).find(".p3-playlist-suggested-results").live("click",function(){$(".p3_floating_segment").remove();var a=$(parent.container).find(".p3-playlist-suggested-search-terms");if(1==$(parent.container).find(".p3-playlist-suggested-search-terms:visible").length){var b=a.outerHeight();a.attr("oheight",b),a.slideUp(200),$(this).addClass("drop_up"),$(parent.container).find(".p3-playlist-results").animate({height:"+="+b},200)}else{var b=a.attr("oheight");$(this).removeClass("drop_up"),a.slideDown(200),$(parent.container).find(".p3-playlist-results").animate({height:"-="+b},200)}}),$(this.container).find(".p3-playlist-searchterm").keyup(function(a){27==(a.keyCode||a.which)&&parent.clear_search()}),$(this.container).find(".p3-playlist-search-form").submit(function(){var a=$(parent.container).find(".p3-playlist-searchterm").val();return parent.search(a),!1}),$(this.container).find(".p3-playlist-search-reset").live("click",function(){parent.clear_search()}),$(this.container).find(".p3-playlist-prev-video").live("click",function(){var a=parent.settings.current_page-1;return 0>=a?!1:void("search"==parent.load_method?parent.search(parent.searchterm,a):parent.all_files(!1,a))}),$(this.container).find(".p3-playlist-next-video").live("click",function(){var a=parent.settings.current_page+1;return a>parent.settings.total_pages?!1:void("search"==parent.load_method?parent.search(parent.searchterm,a):parent.all_files(!1,a))});var a=".p3-playlist-segmentmap td";a+=parent.settings.show_all_results?"":".hit",$(this.container).find(a).live("click",function(a){parent.load_segment({num:$(this).attr("num"),segs_per:$(this).attr("segs_per"),video_id:$(this).attr("video_id"),evt:a})}),$(".p3-playlist-close-segment").live("click",function(){$(".p3_floating_segment").remove()}),$(".p3-playlist-play-from").live("click",function(){var a=$(this).attr("video_id"),b=parseInt($(this).attr("m"),10);parent.instance.player.interface.video_id()==a?(parent.instance.player.interface.play(),setTimeout(function(){parent.instance.player.interface.seek(b)},0)):($(".p3-playlist-ul li").removeClass("p3-playlist-currently-loading"),$(".p3-playlist-ul li[video_id="+a+"]").addClass("p3-playlist-currently-loading"),parent.instance.player.load_video({video_id:a,m:b}))}),$(".p3_floating_segment .hit").live("click",function(){$(this).siblings().removeClass("active_hit"),$(this).addClass("active_hit");var a=$(this).attr("ind"),b=$(this).parents(".p3_floating_segment:first"),c=b.find("p.segment_content:visible:eq("+a+")").offset().top-b.find("p.segment_content:visible:eq(0)").offset().top;b.find(".floating_segment_content").scrollTop(c)}),$(this.container).find(".p3-playlist-results").scroll(function(){$(".p3_floating_segment").remove()})},this.api_request=function(a,b,c){c=c||"js";var d=parent.settings.base_url;d+="p/projects/"+parent.settings.project_id,a&&(d+="/"+a),d+="."+c,arr=[];for(i in b)arr.push(i+"="+encodeURIComponent(b[i]));d+="?"+arr.join("&"),parent.settings.folder_id&&(d+="&batch_id="+parent.settings.folder_id),P3.Util.load_remote_script(d)},this.all_files=function(a,b){this.load_method="all_files";var c="linked_accounts/"+parent.settings.linked_account_id+"/playlist",d={page:b||1,per_page:parent.settings.per_page||10,sortby:parent.settings.list_sort_by.split(":")[0],desc:/\:desc$/.test(parent.settings.list_sort_by)?"1":"0",callback:"P3.instances["+parent.instance.instance_index+"].playlist.parse_playlist_results"};parent.api_request(c,d)},this.clear_search=function(){$(this.container).find(".p3-playlist-search-reset").hide(),$(this.container).find(".p3-playlist-searchterm").val(""),this.all_files()},this.search=function(a,b){{var b=b||1;parent.settings.per_page||10}if(a=a||"",a=a.replace(/^\s+|\s+$/,""),!a)return"search"==this.load_method&&parent.all_files(),!1;$(parent.container).find(".p3-playlist-search-reset").show(),this.searchterm=a,this.load_method="search";var c="linked_accounts/"+parent.settings.linked_account_id+"/segmentmap",d={page:b||1,query:a,per_page:parent.settings.per_page||10,sortby:parent.settings.search_sort_by.split(":")[0],desc:/\:desc$/.test(parent.settings.search_sort_by)?"1":"0",callback:"P3.instances["+parent.instance.instance_index+"].playlist.parse_playlist_results"};parent.api_request(c,d)},this.load_segment=function(a){parent.settings.segment_target_event=a.evt;var b="files/"+a.video_id+"/segments/"+a.num,c={usevideoid:1,segs:a.segs_per,callback:"P3.instances["+parent.instance.instance_index+"].playlist.parse_transcript_segment"};parent.api_request(b,c)},this.parse_transcript_segment=function(obj){$(".p3_floating_segment").remove();var file_id=obj.segments[0].file_id,tr=$(".p3-playlist-container").find("tr[file_id="+file_id+"]"),video_id=$(tr).attr("video_id");obj.video_id=video_id,obj.file_id=file_id;var html=new EJS({text:parent.segment,type:"["}).render(obj),targ=$(tr).parents("table:first"),offset=$(".p3-playlist-container").offset(),width=Math.min(Math.max(250,$(targ).outerWidth()-40),450),height=$(targ).outerHeight(),div=$("<div></div>");if($(div).addClass("p3_floating_segment"),$(div).addClass(parent.settings.skin),$(div).attr("instance_index",parent.instance.instance_index),$(div).html(html),$(document.body).append(div),ll=$(parent.settings.segment_target_event.target).offset().left,ll=ll-$(parent.settings.segment_target_event.target).parents("tbody:first").offset().left-2,ll=Math.max(ll,0),$(".p3-floating-segment-point").css("left",ll),parent.searchterm){var hit_counter=0;$(".p3_floating_segment").find(".segment_content").each(function(){var html=$(this).html(),re=eval("/("+parent.searchterm.replace(/^\s+|\s+$/).replace(/\s+/,"|")+")/ig");re.test(html)||parent.settings.show_all_results?(html=html.replace(re,"<strong>$1</strong>"),$(this).html(html),$(".paragraph_hits ul").append("<li class='hit "+(0==hit_counter?"active_hit":"")+"' ind='"+hit_counter+"'>&nbsp;&nbsp;&nbsp;</li>"),hit_counter++):$(this).hide()}),1>=hit_counter&&$(".paragraph_hits").css("visibility","hidden")}$(div).css({position:"absolute",zIndex:1e15,top:$(tr).offset().top+17+"px",left:$(tr).offset().left+"px",width:width+"px",height:"110px"})},this.parse_playlist_results=function(a){if($(".p3_floating_segment").remove(),a.instance_index=parent.instance_index,a.searchterm=parent.searchterm,a.settings=parent.settings,a.load_method=parent.load_method,a.summary.total_entries>0){var b=new EJS({text:parent.files_list,type:"["}).render(a);$(this.container).find(".p3-playlist-results").fadeTo(150,.6,function(){$(this).html(b),$(this).fadeTo(150,1)}),parent.settings.current_page=a.summary.current_page,parent.settings.total_pages=a.summary.total_pages,$(this.container).find(".p3-playlist-progress-summary").html("page "+a.summary.current_page+" of "+a.summary.total_pages)}else{var b=new EJS({text:parent.empty_files_list,type:"["}).render(a);$(this.container).find(".p3-playlist-results").html(b),$(this.container).find(".p3-playlist-progress-summary").html("0 results")}"search"==parent.load_method?parent.instance.event.trigger("Playlist.SearchResult",{searchterm:a.searchterm}):parent.instance.event.trigger("Playlist.AllFiles")},this.segment='<div class="floating_segment_header">    <div class="paragraph_hits">      <ul></ul>    </div>    <span>      <a href="javascript:void(0);" class="p3-playlist-close-segment">&nbsp;</a>    </span>    </div>    <div class="floating_segment_content">    [% for (i=0;i<segments.length;i++) { %]      <p class="segment_content" attr=[%=i%]>        <span class="p3-playlist-play-from" m="[%=segments[i].timestamp%]" video_id="[%=video_id%]">[%=P3.Util.ms_to_stamp(segments[i].timestamp)%]</span>        <span>"... [%= segments[i].content %]..."</span>      </p>    [% } %]    </div>    <div class="p3-floating-segment-point"></div>',this.empty_files_list='<p class="no-results">No results!</p>',this.files_list='<ul class="p3-playlist-ul p3-playlist-ul-[%=load_method.replace("_","-")%]">    [% for (i=0;i<files.length;i++){ %]      <li video_id="[%=files[i].video_id%]">        <a href="javascript:void(0);">          <span class="p3-playlist-play-button">&nbsp;</span>          [% if (settings.show_thumbnails) {%]            <span class="p3-playlist-thumbnail">              <img src="[%=files[i].thumbnail_url%]" onerror="this.src=\'http://p3.3playmedia.com/images/espresso/thumbnail-error.png\'"/>            </span>          [%}%]          <span class="p3-playlist-video-info">            <p class="p3-playlist-video-title">[%=files[i].name%]</p>            <p class="p3-playlist-meta-field-one">[%=P3.Util.ms_to_stamp(files[i].duration)%]</p>          </span>        </a>        [% if (files[i].segmentmap && settings.show_segments) { %]          <div class="p3-playlist-segmentmap-container">            <table class="p3-playlist-segmentmap" cellSpacing="0">              [%= P3.Util.render_segment_map(files[i].segmentmap, {file_id:files[i].id,video_id:files[i].video_id}, "") %]            </table>          </div>          <div class="p3-playlist-search-results-summary">          </div>        [% } %]      </li>    [% } %]  </ul>',this.template='<div class="p3-container p3-playlist-container">    <div class="p3-playlist-topbar">      <form class="p3-playlist-search-form" action="javascript:void(0);">        <input type="button" class="p3-playlist-suggested-results">        <button class="p3-playlist-submit-search"></button>        <input type="text" class="p3-playlist-searchterm" placeholder="[%=search_box_placeholder%]"/>        <div class="p3-playlist-search-reset">&nbsp;</div>      </form>      [% if (typeof suggested_search_terms == "object" && suggested_search_terms.length > 0) { %]        <div class="p3-playlist-suggested-search-terms">          Keywords:&nbsp;          [% for (i=0;i<suggested_search_terms.length;i++){%]            <a href="javascript:void(0);">[%=suggested_search_terms[i]%]</a>          [% } %]        </div>      [% } %]    </div>    <div class="p3-playlist-results"></div>    <div class="p3-playlist-bottombar">      <div class="p3-playlist-video-control">        <span class="p3-playlist-next-video"></span>        <span class="p3-playlist-progress-summary">&nbsp;</span>        <span class="p3-playlist-prev-video"></span>      </div>    </div>  </div>',$(instance).bind("Player.Progress",function(a,b){var c=$(parent.container).find("li[video_id="+b.video_id+"]");return c.hasClass("p3-playlist-currently-playing")?!1:($(parent.container).find("li.p3-playlist-currently-playing").removeClass("p3-playlist-currently-playing"),c.removeClass("p3-playlist-currently-loading"),c.addClass("p3-playlist-currently-playing"),void 0)}),this.init()};var TECHTVID=21824,rpc=new easyXDM.Rpc({remote:"http://techtv.mit.edu/embeds/"+TECHTVID,container:"video",props:{style:{width:442,height:200}}},{local:{play:function(){},pause:function(){},stop:function(){},resume:function(){},toggle:function(){},seek:function(){},isPlaying:function(){},isPaused:function(){},playState:function(){},position:function(){},duration:function(){},videoId:function(){},playFile:function(){}},remote:{play:{},pause:{},stop:{},resume:{},toggle:{},seek:{},isPlaying:{},isPaused:{},playState:{},position:{},duration:{},videoId:{},playFile:{}}});window.p3_async_init=function(){P3.PlayerInterface.techtv=function(a,b){var c=this;if(c.instance=b,this.playState="paused",this.playPosition=!1,this.playDuration=!1,this.playVideoId=TECHTVID,"undefined"!=typeof rpc&&rpc.play){this.play=function(){rpc.play()},this.pause=function(){rpc.pause()},this.play_state=function(){return c.playState},this.position=function(){return c.playPosition},this.video_id=function(){return c.playVideoId},this.duration=function(){return c.playDuration},this.seek=function(a){rpc.play(),setTimeout(function(){var b=a/1e3;rpc.seek(b)},0)},this.play_file=function(a){m=a.m||0,a.video_id==c.playVideoId?c.seek(m):rpc.playFile(a.video_id,m/1e3)};var d=333,e=3e3;this.stat_interval=setInterval(function(){rpc.position(null,function(a){P3.get(0).player.interface.playPosition=1e3*a})},d),this.long_stat_interval=setInterval(function(){rpc.isPlaying(null,function(a){P3.get(0).player.interface.playState=a?"PLAYING":"PAUSED"}),rpc.duration(null,function(a){P3.get(0).player.interface.playDuration=1e3*a}),rpc.videoId(null,function(a){P3.get(0).player.interface.playVideoId=a})},e)}},P3.init({video:{player_type:"techtv",file_id:TECHTVID,platform_integration:!0,transcript:{target:"transcript",skin:"minimal mitlib",width:432,height:214,can_print:!0,can_download:!0,can_collapse:!0,search_box_placeholder:"Search by name or keyword"},playlist:{target:"collection",playlist_height:350,width:432,list_sort_by:"name",search_sort_by:"name",show_all_results:!1,skin:"minimal mitlib",linked_account_id:894,project_id:10129,suggested_search_terms:[],per_page:1e3,search_box_placeholder:"Search by name or keyword"}}},"h_RJzPyn1vwbLhFaDLRxJUoNvT_756xr")},$(document).ready(function(){$("#transcriptskin").change(function(){P3.get(0).transcript.apply_skin($(this).val())}),$("#playlistskin").change(function(){P3.get(0).playlist.apply_skin($(this).val())})});